<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>сЃГсЃѕ7 С║ѕТЃ│сѓисЃЪсЃЦсЃгсЃ╝сѓ┐сЃ╝</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans JP', sans-serif;
            background-color: #f3f4f6;
        }
        /* сЃГсЃѕсЂ«сЃюсЃ╝сЃФжбесЃЄсѓХсѓцсЃ│ */
        .loto-ball {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 900;
            font-size: 1.25rem;
            color: white;
            box-shadow: inset -2px -2px 6px rgba(0,0,0,0.3), 2px 2px 4px rgba(0,0,0,0.1);
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
        }
        /* уЋфтЈитИ»сЂћсЂесЂ«УЅ▓тѕєсЂЉ */
        .ball-yellow { background: linear-gradient(135deg, #fbbf24, #d97706); color: #000; text-shadow: none; }
        .ball-blue { background: linear-gradient(135deg, #60a5fa, #2563eb); }
        .ball-red { background: linear-gradient(135deg, #f87171, #dc2626); }
        .ball-green { background: linear-gradient(135deg, #34d399, #059669); }
        
        /* тЄдуљєСИГсЂ«сѓ╣сЃћсЃісЃ╝ */
        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="text-gray-800 p-4 md:p-8">

    <div class="max-w-4xl mx-auto bg-white rounded-2xl shadow-xl overflow-hidden relative">
        <!-- сЃўсЃЃсЃђсЃ╝ -->
        <div class="relative bg-gradient-to-r from-indigo-600 to-purple-700 p-6 text-white text-center">
            <button id="btnHelp" class="absolute top-4 right-4 bg-white/20 hover:bg-white/30 text-white rounded-full py-1.5 px-4 transition flex items-center gap-1 text-sm font-bold shadow-sm backdrop-blur-sm">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                сЃўсЃФсЃЌ
            </button>
            <h1 class="text-3xl font-black mb-2 tracking-wider mt-8 md:mt-0">­Ъј» сЃГсЃѕ7 С║ѕТЃ│сѓисЃЪсЃЦсЃгсЃ╝сѓ┐сЃ╝</h1>
            <p class="text-sm opacity-90">сЃЈсѓцсЃќсЃфсЃЃсЃЅHuberТљЇтц▒ №╝є сЃюсЃфсЃЦсЃ╝сЃасѓЙсЃ╝сЃ│сЃ╗сѓГсЃБсЃфсЃќсЃгсЃ╝сѓисЃДсЃ│AI</p>
        </div>

        <div class="p-6 md:p-8 space-y-8">
            
            <!-- STEP 1: сЃЄсЃ╝сѓ┐Т║ќтѓЎ -->
            <section class="bg-gray-50 p-6 rounded-xl border border-gray-200">
                <h2 class="text-xl font-bold border-b-2 border-indigo-500 pb-2 mb-4">STEP 1: жЂјтј╗сЃЄсЃ╝сѓ┐сЂ«Т║ќтѓЎ</h2>
                <p class="text-sm text-gray-600 mb-4">
                    жЂјтј╗сЂ«тйЊсЂЏсѓЊуЋфтЈисЃЄсЃ╝сѓ┐сѓњсЃєсѓГсѓ╣сЃѕсѓесЃфсѓбсЂФУ▓╝сѓіС╗ўсЂЉсЂдсЂЈсЂасЂЋсЂёсђѓ<br>
                    <span class="text-indigo-600 font-bold">№╝ѕРђ╗тѕЮТюЪуіХТЁІсЂДугг1тЏъсђюугг665тЏъсЂ«тЁесЃЄсЃ╝сѓ┐сЂїсЃГсЃ╝сЃЅсЂЋсѓїсЂдсЂёсЂЙсЂЎ№╝Ѕ</span>
                </p>
                <textarea id="csvData" rows="6" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 text-xs font-mono mb-2" placeholder="сЃЄсЃ╝сѓ┐УфГсЂ┐УЙ╝сЂ┐СИГ..."></textarea>
                
                <div class="mb-4">
                    <label class="inline-flex items-center text-sm text-gray-700 cursor-pointer">
                        <input type="checkbox" id="includeBonus" class="rounded text-indigo-600 focus:ring-indigo-500" checked>
                        <span class="ml-2">сЃюсЃ╝сЃісѓ╣ТЋ░тГЌсѓѓтЁеСйЊтЄ║уЈЙжа╗т║дсЂ«жЏєУеѕсЂФтљФсѓЂсѓІ</span>
                    </label>
                </div>

                <div class="mb-4 bg-white p-3 border border-indigo-200 rounded-lg shadow-sm">
                    <span class="block text-sm font-bold text-gray-700 mb-2">УДБТъљсЃбсЃ╝сЃЅжЂИТіъ:</span>
                    <div class="flex flex-col sm:flex-row gap-4">
                        <label class="flex items-center gap-2 cursor-pointer bg-gray-50 px-3 py-2 rounded border hover:bg-gray-100 transition">
                            <input type="radio" name="analyzeMode" value="predict" checked class="text-indigo-600 focus:ring-indigo-500 w-4 h-4">
                            <span class="text-sm text-gray-800"><b>жђџтИИС║ѕТЃ│</b> <span class="text-xs text-gray-500">№╝ѕтЁесЃЄсЃ╝сѓ┐сѓњСй┐сЂБсЂдТгАтЏъсЂ«С║ѕТЃ│сѓњсЂЎсѓІ№╝Ѕ</span></span>
                        </label>
                        <label class="flex items-center gap-2 cursor-pointer bg-indigo-50 px-3 py-2 rounded border border-indigo-100 hover:bg-indigo-100 transition">
                            <input type="radio" name="analyzeMode" value="backtest" class="text-indigo-600 focus:ring-indigo-500 w-4 h-4">
                            <span class="text-sm font-bold text-indigo-700">жЂјтј╗ТцюУе╝№╝ѕсЃљсЃЃсѓ»сЃєсѓ╣сЃѕ№╝Ѕ <span class="text-xs text-indigo-500 font-normal">№╝ѕСИђуЋфСИІсЂ«УАїсѓњТГБУДБсЂесЂЌсЂджџасЂЌсђЂсЃєсѓ╣сЃѕсЂЎсѓІ№╝Ѕ</span></span>
                        </label>
                    </div>
                </div>

                <div class="mt-3 flex flex-wrap gap-4">
                    <button id="btnMockData" class="bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold py-2 px-4 rounded transition">
                        ­ЪДф сЃєсѓ╣сЃѕућесЃђсЃЪсЃ╝сЃЄсЃ╝сѓ┐сѓњућЪТѕљ
                    </button>
                    <button id="btnAnalyze" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg shadow-md transition flex items-center gap-2 w-full md:w-auto justify-center">
                        <span class="text-lg">­ЪЊі AIТи▒т▒цтГду┐њсЂесЃЄсЃ╝сѓ┐УДБТъљсѓњт«ЪУАї</span>
                    </button>
                </div>
            </section>

            <!-- STEP 2: тѕєТъљухљТъю -->
            <section id="analysisSection" class="hidden">
                <h2 id="analysisTitle" class="text-xl font-bold border-b-2 border-blue-500 pb-2 mb-4">STEP 2: тГду┐њухљТъю №╝є AIсЃЉсЃЕсЃАсЃ╝сѓ┐ТюђжЂЕтїќ</h2>
                
                <!-- AIУЄфти▒тГду┐њухљТъю -->
                <div class="bg-gradient-to-br from-gray-800 to-gray-900 p-5 rounded-xl border border-gray-700 shadow-lg text-sm text-gray-200 mb-6">
                    <h3 class="font-bold text-yellow-400 mb-2 border-b border-gray-600 pb-2 flex items-center gap-2">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"></path></svg>
                        ­Ъцќ FisherтѕцтѕЦТ»ћсЂФтЪ║сЂЦсЂЈAIсЃџсЃісЃФсЃєсѓБТюђжЂЕтїќухљТъю
                    </h3>
                    <p class="text-xs text-gray-400 mb-4">сђїТГБУДБсЃЄсЃ╝сѓ┐сђЇсЂесђїсЃЈсѓ║сЃг№╝ѕтю░жЏи№╝ЅсЃЄсЃ╝сѓ┐сђЇсЂ«уЅ╣тЙ┤жЄЈсЂ«ти«тѕєсѓњТЋ░тГдуџёсЂФУеѕу«ЌсЂЌсђЂтю░жЏисѓњТюђсѓѓжФўу▓Йт║дсЂФУГўтѕЦсЃ╗ТјњжЎцсЂДсЂЇсѓІТїЄТеЎсЂФжЄЇсЂ┐сѓњУЄфтІЋтѕєжЁЇсЂЌсЂЙсЂЌсЂЪсђѓ</p>
                    <div id="aiWeightsDisplay" class="space-y-3">
                        <!-- JSсЂДсЃљсЃ╝сѓњТї┐тЁЦ -->
                    </div>
                </div>

                <div class="bg-indigo-50 p-4 rounded-lg border border-indigo-200 mb-6 flex flex-col md:flex-row items-center justify-between gap-4 shadow-sm">
                    <div>
                        <h3 class="font-bold text-indigo-800 mb-1">­ЪЊї уЏ┤У┐Љ№╝ѕТюђТќ░тЏъ№╝ЅсЂ«тйЊсЂЏсѓЊТЋ░тГЌ</h3>
                        <p class="text-sm text-indigo-600">сЂЊсЂ«ТЋ░тГЌсЂІсѓЅсЂ«т╝ЋсЂБт╝хсѓісѓёсђЂ┬▒1сЂ«жџБТјЦТ│бтЈіті╣ТъюсђЂтљёТЋ░тГЌсЂ«сѓцсЃ│сѓ┐сЃ╝сЃљсЃФсѓњУеѕу«ЌсЂЌсЂЙсЂЎсђѓ</p>
                    </div>
                    <div id="latestDraw" class="flex gap-1 font-bold text-lg"></div>
                </div>

                <!-- сЃЪсѓ»сЃГсЂфТЋ░тГЌтѕєТъљUI -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                    <div class="bg-purple-50 p-4 rounded-lg border border-purple-200 shadow-sm">
                        <h3 class="font-bold text-purple-800 mb-2 border-b border-purple-300 pb-1">­Ъњъ Тюђт╝исЂ«уЏИТђДсЃџсѓб (тљїТЎѓтЄ║уЈЙTop10)</h3>
                        <p class="text-xs text-purple-600 mb-2">жЂјтј╗сЂ«тЁеТійсЂЏсѓЊсЂДсђїСИђуињсЂФжЂИсЂ░сѓїсѓёсЂЎсЂІсЂБсЂЪсђЇТЋ░тГЌсЂ«ухёсЂ┐тљѕсѓЈсЂЏсЂДсЂЎсђѓ</p>
                        <ul id="bestPairs" class="space-y-1 text-sm text-purple-900 font-mono"></ul>
                    </div>
                    <div class="bg-teal-50 p-4 rounded-lg border border-teal-200 shadow-sm">
                        <h3 class="font-bold text-teal-800 mb-2 border-b border-teal-300 pb-1">­ЪЊі сѓѕсЂЈтЄ║сѓІуЋфтЈ░сЃЉсѓ┐сЃ╝сЃ│ (1ТАЂ:10С╗Б:20С╗Б:30С╗Б)</h3>
                        <p class="text-xs text-teal-600 mb-2">1ТАЂсђю30уЋфтЈ░сЂїсђЂсЂЮсѓїсЂъсѓїсђїСйЋтђІсЂџсЂцсђЇжЂИсЂ░сѓїсѓёсЂЎсЂёсЂІсЂ«уб║ујЄтѕєтИЃсЂДсЂЎсђѓ</p>
                        <ul id="bestDecades" class="space-y-2 text-sm text-teal-900"></ul>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                    <div class="bg-red-50 p-4 rounded-lg border border-red-100 shadow-sm">
                        <h3 class="font-bold text-red-700 mb-2">­ЪћЦ тЁеТюЪжќЊ Hot Numbers</h3>
                        <ul id="hotNumbers" class="space-y-1 text-sm"></ul>
                    </div>
                    <div class="bg-blue-50 p-4 rounded-lg border border-blue-100 shadow-sm">
                        <h3 class="font-bold text-blue-700 mb-2">РЮё№ИЈ сѓ╣сЃЕсЃ│сЃЌ№╝ѕжЋиТюЪжќЊсЂ»сЂЙсѓі№╝ЅТЋ░тГЌ</h3>
                        <p class="text-xs text-blue-600 mb-2 border-b border-blue-200 pb-1">уЈЙтюесђЂСйЋтЏъжђБуХџсЂДтЄ║сЂдсЂёсЂфсЂёсЂІ№╝ѕсѓцсЃ│сѓ┐сЃ╝сЃљсЃФ№╝ЅсЂїжЋисЂёТЋ░тГЌ</p>
                        <ul id="coldNumbers" class="space-y-1 text-sm"></ul>
                    </div>
                </div>

                <div class="bg-white p-4 rounded-lg border border-gray-200 shadow-sm text-sm text-gray-700">
                    <h3 class="font-bold text-gray-800 mb-3 border-b pb-1">­ЪЊі тГду┐њсЂЌсЂЪсђїуЈЙт«ЪсЂ«ТГБУДБсЃЄсЃ╝сѓ┐сђЇсЂ«тѕєтИЃсЃЌсЃГсЃЋсѓАсѓцсЃФ№╝ѕт╣│тЮЄ┬▒ТеЎТ║ќтЂЈти«№╝Ѕ</h3>
                    <ul id="statisticalFeatures" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-y-4 gap-x-6">
                        <!-- JSсЂДТї┐тЁЦ -->
                    </ul>
                </div>

                <!-- жЂјтј╗сЃЄсЃ╝сѓ┐сЂ«сѓ╣сѓ│сѓбтѕєтИЃ -->
                <div class="bg-white p-5 rounded-xl border-2 border-indigo-100 shadow-sm text-sm text-gray-700 mt-6 hidden" id="histScoreSection">
                    <h3 class="font-bold text-gray-800 mb-2 border-b border-indigo-100 pb-2">­ЪЊі жЂјтј╗сЂ«ТГБУДБсѓ╣сѓ│сѓбТјеуД╗сЃ╗тѕєтИЃтѕєТъљ№╝ѕтЪ║уцјсЃЌсЃГсЃЋсѓАсѓцсЃФ№╝Ѕ</h3>
                    <p class="text-xs text-gray-500 mb-4">тљётЏъсЂ«ТійсЂЏсѓЊТЎѓуѓ╣сЂДсђїсЂЮсѓїсѓѕсѓітЅЇсЂ«тЁесЃЄсЃ╝сѓ┐сђЇсѓњСй┐сЂБсЂдтГду┐њсЂЌсђЂсЂЮсЂ«тЏъсЂ«ТГБУДБухљТъюсЂї<b class="text-indigo-600">Тќ░HuberТљЇтц▒сЃбсЃЄсЃФсЂДСйЋуѓ╣сЂ«тЪ║уцјсѓ╣сѓ│сѓбсЂасЂБсЂЪсЂІ</b>сѓњУеѕу«ЌсЂЌсЂЪт«ЪуИЙсЂДсЂЎсђѓ<br><span class="text-red-500 font-bold">Рђ╗сѓисЃЪсЃЦсЃгсЃ╝сѓисЃДсЃ│ТЎѓсЂФсЂ»сђЂсЂЊсЂ«сђїт╣│тЮЄтЪ║уцјсѓ╣сѓ│сѓб№╝ѕТюђсѓѓтѕєтјџсЂёсЃюсЃфсЃЦсЃ╝сЃасѓЙсЃ╝сЃ│№╝ЅсђЇсЂФТюђсѓѓУ┐ЉсЂёТ│бтйбсЂїсђЂТюђжЂЕтїќсѓ╣сѓ│сѓб10,000уѓ╣№╝ѕт░цт║дТюђтцД№╝ЅсЂесЂфсѓІсѓѕсЂєсЂФсѓГсЃБсЃфсЃќсЃгсЃ╝сѓисЃДсЃ│№╝ѕУЄфти▒УБюТГБ№╝ЅсЂЋсѓїсЂЙсЂЎсђѓ</span></p>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                        <div>
                            <h4 class="font-bold text-indigo-700 mb-3">тЪ║уцјсѓ╣сѓ│сѓбтИ»сЂћсЂесЂ«тйЊжЂИС╗ХТЋ░</h4>
                            <div id="scoreDistribution" class="space-y-2">
                                <!-- JSсЂДТї┐тЁЦ -->
                            </div>
                        </div>
                        <div>
                            <h4 class="font-bold text-indigo-700 mb-3">сЃюсЃфсЃЦсЃ╝сЃасѓЙсЃ╝сЃ│ух▒УеѕТЃЁта▒</h4>
                            <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
                                <div class="flex justify-between items-center mb-3 pb-3 border-b border-gray-200">
                                    <span class="text-gray-600 font-bold">тЁеТюЪжќЊсЂ«т╣│тЮЄтЪ║уцјсѓ╣сѓ│сѓб:<br><span class="text-xs text-gray-500 font-normal">№╝ѕсѓисЃЪсЃЦсЃгсЃ╝сѓисЃДсЃ│сЂ«сѓ┐сЃ╝сѓ▓сЃЃсЃѕсЃ╗сѓЙсЃ╝сЃ│№╝Ѕ</span></span> 
                                    <b id="avgHistScore" class="text-3xl text-indigo-600"></b>
                                </div>
                                <div class="mt-2">
                                    <span class="block mb-2 text-gray-600 font-bold">уЏ┤У┐Љ10С╗ХсЂ«тЪ║уцјсѓ╣сѓ│сѓбТјеуД╗:</span>
                                    <ul id="recentHistScores" class="text-xs space-y-2 max-h-48 overflow-y-auto pr-2">
                                        <!-- JSсЂДТї┐тЁЦ -->
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- STEP 3: сѓисЃЪсЃЦсЃгсЃ╝сѓисЃДсЃ│ -->
            <section id="simulationSection" class="hidden bg-gray-800 text-white p-6 rounded-xl border border-gray-700 shadow-inner">
                <h2 class="text-xl font-bold border-b-2 border-gray-500 pb-2 mb-4 text-yellow-400">STEP 3: сЃюсЃфсЃЦсЃ╝сЃасѓЙсЃ╝сЃ│ТюђжЂЕтїќсѓисЃЪсЃЦсЃгсЃ╝сѓисЃДсЃ│</h2>
                
                <div class="flex flex-col gap-5 mb-6">
                    <div class="flex flex-col md:flex-row md:items-start gap-4">
                        <label class="font-bold text-gray-200 shrink-0 mt-2">сѓисЃЪсЃЦсЃгсЃ╝сѓисЃДсЃ│Тќ╣т╝Ј:</label>
                        <div class="flex flex-col gap-3 bg-gray-900 p-4 rounded-lg w-full">
                            <label class="flex items-start gap-2 cursor-pointer group">
                                <input type="radio" name="simMode" value="count" checked class="mt-1 text-yellow-500 focus:ring-yellow-500 w-4 h-4">
                                <span class="text-sm group-hover:text-yellow-200 transition">тЏъТЋ░ТїЄт«џсЃбсЃ╝сЃЅ<br><span class="text-xs text-gray-400">№╝ѕТїЄт«џсЂЌсЂЪтЏъТЋ░сЂасЂЉтЏъсЂЌсђЂсЂЮсЂ«СИГсЂ«СИіСйЇсѓњТійтЄ║№╝Ѕ</span></span>
                            </label>
                            <label class="flex items-start gap-2 cursor-pointer group pt-2 border-t border-gray-700">
                                <input type="radio" name="simMode" value="all" class="mt-1 text-yellow-500 focus:ring-yellow-500 w-4 h-4">
                                <span class="text-sm text-yellow-300 font-bold group-hover:text-yellow-100 transition">тЁесЃЉсѓ┐сЃ╝сЃ│т«їтЁеУДБТъљсЃбсЃ╝сЃЅ (Т┐ђжЂИТјетЦе)<br><span class="text-xs text-yellow-600/70">№╝ѕтЁе10,295,472жђџсѓісѓњУеѕу«ЌсЂЌсђЂAIсЂїуЅ╣т«џсЂЌсЂЪуЈЙт«ЪсЂ«сЃюсЃфсЃЦсЃ╝сЃасѓЙсЃ╝сЃ│сЂФТюђсѓѓУ┐ЉсЂёТ│бсѓњТійтЄ║сЂЌсЂЙсЂЎ№╝Ѕ</span></span>
                            </label>
                        </div>
                    </div>
                    
                    <div class="flex flex-wrap items-center gap-6 p-4 bg-gray-700/50 rounded-lg border border-gray-600">
                        <!-- тЏъТЋ░ТїЄт«џућеUI -->
                        <div id="countModeUI" class="flex items-center gap-2">
                            <label class="font-bold text-gray-200 text-sm shrink-0">С╗«ТЃ│ТійжЂИтЏъТЋ░:</label>
                            <select id="simCount" class="p-2 border border-gray-600 rounded bg-gray-700 text-white text-sm">
                                <option value="10000">10,000тЏъ</option>
                                <option value="50000" selected>50,000тЏъ</option>
                                <option value="100000">100,000тЏъ</option>
                            </select>
                        </div>
                        
                        <!-- тЁесЃЉсѓ┐сЃ╝сЃ│ТїЄт«џућеUI -->
                        <div id="allModeUI" class="flex items-center gap-2 hidden">
                            <span class="text-yellow-400 text-sm font-bold">Рђ╗тЁе10,295,472сЃЉсѓ┐сЃ╝сЃ│сѓњУДБТъљсЂЎсѓІсЂЪсѓЂсђЂт«їС║єсЂЙсЂДТЋ░уДњсђютЇЂТЋ░уДњсЂІсЂІсѓісЂЙсЂЎсђѓ</span>
                        </div>

                        <div class="flex items-center gap-2 mt-2 md:mt-0">
                            <label class="font-bold text-gray-200 text-sm shrink-0">С║ѕТЃ│ТійтЄ║тЈБТЋ░:</label>
                            <select id="ticketCount" class="p-2 border border-gray-600 rounded bg-gray-700 text-white text-sm">
                                <option value="1">1тЈБ</option>
                                <option value="2">2тЈБ</option>
                                <option value="3">3тЈБ</option>
                                <option value="4">4тЈБ</option>
                                <option value="5" selected>5тЈБ</option>
                                <option value="6">6тЈБ</option>
                                <option value="7">7тЈБ</option>
                                <option value="8">8тЈБ</option>
                                <option value="9">9тЈБ</option>
                                <option value="10">10тЈБ</option>
                            </select>
                        </div>
                    </div>
                </div>
                <button id="btnSimulate" class="w-full bg-gradient-to-r from-yellow-500 to-yellow-600 hover:from-yellow-600 hover:to-yellow-700 text-gray-900 font-black py-4 px-4 rounded-lg shadow-lg transition flex justify-center items-center gap-2 text-lg">
                    <span>­Ъј░ сЃюсЃфсЃЦсЃ╝сЃасѓЙсЃ╝сЃ│ТюђжЂЕтїќС║ѕТЃ│сѓњжќІтДІсЂЎсѓІ</span>
                </button>
            </section>

            <!-- ухљТъюУАеуц║ -->
            <section id="resultSection" class="hidden">
                <h2 class="text-2xl font-black text-center text-gray-800 mb-6 border-b-4 border-indigo-500 inline-block pb-2">Рюе ух▒УеѕжЂЕтљѕт║дсЃЕсЃ│сѓГсЃ│сѓ░С║ѕТЃ│ Рюе</h2>
                <div id="predictionResults" class="space-y-4">
                    <!-- JSсЂДухљТъюсѓњТї┐тЁЦ -->
                </div>
            </section>

        </div>
    </div>

    <!-- сЃўсЃФсЃЌсЃбсЃ╝сЃђсЃФ -->
    <div id="helpModal" class="fixed inset-0 bg-gray-900/60 z-50 hidden flex justify-center items-center p-4 backdrop-blur-sm transition-opacity">
        <div class="bg-white rounded-xl shadow-2xl w-full max-w-2xl max-h-[90vh] flex flex-col overflow-hidden transform transition-all">
            <!-- сЃўсЃЃсЃђсЃ╝ -->
            <div class="p-4 bg-gradient-to-r from-indigo-600 to-purple-700 text-white flex justify-between items-center">
                <h2 class="font-bold text-lg flex items-center gap-2">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                    ТюђТќ░сѓбсЃФсѓ┤сЃфсѓ║сЃасЂ«С╗ЋухёсЂ┐сЂеСй┐сЂёТќ╣
                </h2>
                <button id="btnCloseHelp" class="text-white hover:text-gray-200 focus:outline-none bg-white/10 rounded p-1">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                </button>
            </div>
            
            <!-- сѓ│сЃ│сЃєсЃ│сЃё -->
            <div class="p-6 overflow-y-auto text-sm text-gray-700 space-y-8 bg-gray-50">
                <section>
                    <h3 class="text-lg font-bold text-indigo-700 border-b-2 border-indigo-200 pb-1 mb-3">­Ъј» 1. сЃюсЃфсЃЦсЃ╝сЃасѓЙсЃ╝сЃ│сЃ╗сѓГсЃБсЃфсЃќсЃгсЃ╝сѓисЃДсЃ│</h3>
                    <p class="mb-2">тцџТгАтЁЃсЃЄсЃ╝сѓ┐сЂФсЂісЂёсЂдсђЂсЂЎсЂ╣сЂдсЂ«ТЮАС╗ХсЂДТ║ђуѓ╣сѓњтЈќсѓІсЂЊсЂе№╝ѕуљєУФќСИісЂ«10000уѓ╣№╝ЅсЂ»ТгАтЁЃсЂ«тЉфсЂёсЂФсѓѕсѓіуЈЙт«ЪсЂФсЂ»УхисЂЊсѓітЙЌсЂЙсЂЏсѓЊсђѓуЈЙт«ЪсЂ»жЂЕт║дсЂфсЃјсѓцсѓ║№╝ѕУЇњсѓї№╝ЅсѓњтљФсѓЊсЂасђї8000уѓ╣сђю9000уѓ╣тЈ░сЂ«т▒цсђЇсЂФТюђсѓѓжЏєСИГсЂЌсЂЙсЂЎсђѓ</p>
                    <p>тйЊсѓисЃЪсЃЦсЃгсЃ╝сѓ┐сЃ╝сЂ»сђЂ<b>сђїжЂјтј╗сЂ«ТГБУДБсЃЄсЃ╝сѓ┐сЂїт╣│тЮЄуџёсЂФтЄ║сЂЌсЂдсЂёсѓІтЪ║уцјсѓ╣сѓ│сѓб№╝ѕТюђсѓѓтѕєтјџсЂёсЃюсЃфсЃЦсЃ╝сЃасѓЙсЃ╝сЃ│№╝ЅсђЇсѓњсѓ┐сЃ╝сѓ▓сЃЃсЃѕсЂесЂЌсЂдУеГт«џсЂЌсђЂсЂЮсЂЊсЂФТюђсѓѓУ┐ЉсЂёТ│бтйбсѓњсђїТюђухѓуџёсЂфТюђжЂЕтїќсѓ╣сѓ│сѓб10,000уѓ╣сђЇсЂесЂЌсЂдУЕЋСЙА№╝ѕУЄфти▒УБюТГБ№╝Ѕ</b>сЂЌсЂЙсЂЎсђѓсЂЊсѓїсЂФсѓѕсѓісђЂуХ║ж║ЌсЂЎсЂјсѓІтцќсѓїтђцсѓњт╝ЙсЂЇсђЂуюЪсЂ«уЈЙт«ЪуџёсЂфТ│бсѓњуІЎсЂёТњЃсЂАсЂЌсЂЙсЂЎсђѓ</p>
                </section>

                <section>
                    <h3 class="text-lg font-bold text-indigo-700 border-b-2 border-indigo-200 pb-1 mb-3">­ЪЏА№ИЈ 2. сЃЈсѓцсЃќсЃфсЃЃсЃЅHuberТљЇтц▒жќбТЋ░№╝ѕуЋ░тИИтђцТјњжЎц№╝Ѕ</h3>
                    <p class="mb-2">сЂЊсѓїсЂЙсЂДсЂ«AIсЂ»т░ЉсЂЌсЂ«сѓ║сЃгсЂФт»ЙсЂЌсЂдсѓѓтј│сЂЌсЂЈТИЏуѓ╣сЂЌсЂЎсЂјсЂдсЂёсЂЙсЂЌсЂЪсђѓТќ░сЃбсЃЄсЃФсЂДсЂ»сђЂ<b>сђї1¤Ѓ№╝ѕТеЎТ║ќтЂЈти«№╝ЅсЂЙсЂДсЂ«сѓ║сЃгсЂ»С║║жќЊтЉ│сЂ«сЂѓсѓІТЎ«жђџсЂ«Т│бсЂесЂЌсЂдУе▒т«╣сЂЌсђЂ2¤ЃсѓњУХЁсЂѕсѓІуЋ░тИИтђц№╝ѕтю░жЏи№╝ЅсЂФт»ЙсЂЌсЂдсЂ«сЂ┐С║їТгАжќбТЋ░уџёсЂФуа┤тБіуџёсЂфсЃџсЃісЃФсЃєсѓБсѓњСИјсЂѕсѓІсђЇ</b>сЂесЂёсЂєHuberТљЇтц▒сЃЕсѓцсѓ»сЂфУеѕу«Ќт╝ЈсѓњТјАућесЂЌсЂЙсЂЌсЂЪсђѓсЂЊсѓїсЂФсѓѕсѓісђЂтЪ║уцјсѓ╣сѓ│сѓбсЂїУЄфуёХсЂе8000сђю9000уѓ╣тЈ░сЂФжЏєсЂЙсѓІсѓѕсЂєсЂФсЂфсѓісЂЙсЂЎсђѓ</p>
                </section>
                
                <section>
                    <h3 class="text-lg font-bold text-indigo-700 border-b-2 border-indigo-200 pb-1 mb-3">­ЪДа 3. FisherтѕцтѕЦТ»ћсЂФтЪ║сЂЦсЂЈAIУЄфтІЋТюђжЂЕтїќ</h3>
                    <p class="mb-2">УДБТъљсЃюсѓ┐сЃ│сѓњТі╝сЂЎсЂесђЂтєЁжЃесЂД<b>сђїжЂјтј╗сЂ«ТГБУДБсЃЄсЃ╝сѓ┐сђЇсЂесђїтцДжЄЈсЂ«сЃЈсѓ║сЃг№╝ѕсЃђсЃЪсЃ╝№╝ЅсЃЄсЃ╝сѓ┐сђЇсѓњТ»ћУ╝Ѓ</b>сЂЌсЂЙсЂЎсђѓсЂЕсЂ«ТїЄТеЎсѓњтј│сЂЌсЂЈсЃЂсѓДсЃЃсѓ»сЂЎсѓїсЂ░ТюђсѓѓжФўу▓Йт║дсЂФсЃЈсѓ║сЃгсѓњт╝ЙсЂЇтЄ║сЂЏсѓІсЂІсђЂсЂЮсЂ«сђїтѕєжЏбУЃйтіЏ№╝ѕFisherсЂ«тѕцтѕЦТ»ћ№╝ЅсђЇсѓњТЋ░тГдуџёсЂФУеѕу«ЌсЂЌсђЂсЃџсЃісЃФсЃєсѓБсЂ«жЄЇсЂ┐сѓњУЄфтІЋтѕєжЁЇсЂЌсЂЙсЂЎсђѓ</p>
                </section>
            </div>
            
            <!-- сЃЋсЃЃсѓ┐сЃ╝ -->
            <div class="p-4 bg-white border-t flex justify-end">
                <button id="btnCloseHelpFooter" class="bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold py-2 px-6 rounded transition">
                    жќЅсЂўсѓІ
                </button>
            </div>
        </div>
    </div>

    <script>
        // --- РўЁ тѕЮТюЪсЃЄсЃ╝сѓ┐сЂ«ТіЋтЁЦ (угг1тЏъсђюугг665тЏъ) РўЁ ---
        const initialRawData = `угг1тЏъ,7,10,12,17,23,28,34,3,15
угг2тЏъ,20,24,29,31,33,34,35,12,32
угг3тЏъ,2,7,8,11,14,23,31,5,15
угг4тЏъ,12,13,22,23,24,28,29,2,14
угг5тЏъ,1,3,4,5,16,21,28,22,31
угг6тЏъ,5,15,19,23,30,34,35,6,25
угг7тЏъ,1,3,5,7,27,29,33,6,15
угг8тЏъ,2,21,28,29,30,32,36,6,8
угг9тЏъ,3,4,15,23,27,30,36,13,35
угг10тЏъ,1,2,3,6,24,28,30,16,20
угг11тЏъ,9,15,26,29,32,34,36,14,35
угг12тЏъ,11,12,14,19,26,27,33,24,32
угг13тЏъ,6,10,16,21,27,28,35,15,34
угг14тЏъ,4,7,8,9,24,28,30,34,36
угг15тЏъ,2,10,14,17,23,25,35,8,29
угг16тЏъ,5,6,9,13,16,21,23,8,34
угг17тЏъ,2,3,5,22,34,36,37,7,15
угг18тЏъ,12,17,21,24,29,31,36,20,26
угг19тЏъ,2,14,19,20,21,22,31,1,15
угг20тЏъ,2,5,13,20,21,23,28,11,22
угг21тЏъ,1,9,13,15,25,30,33,19,28
угг22тЏъ,2,4,8,9,15,23,25,3,10
угг23тЏъ,4,8,11,25,28,29,30,14,32
угг24тЏъ,4,5,8,10,16,19,33,2,29
угг25тЏъ,1,6,11,16,17,18,21,10,24
угг26тЏъ,11,13,16,18,26,31,36,21,27
угг27тЏъ,1,10,11,14,17,18,28,25,26
угг28тЏъ,6,7,12,15,19,35,37,1,11
угг29тЏъ,2,3,16,17,24,26,28,15,31
угг30тЏъ,6,8,13,22,26,32,36,16,34
угг31тЏъ,9,12,13,19,23,33,34,20,32
угг32тЏъ,3,8,15,18,27,29,37,31,34
угг33тЏъ,1,4,17,24,29,33,36,19,30
угг34тЏъ,4,6,7,23,24,32,35,8,27
угг35тЏъ,1,16,18,19,25,30,34,26,36
угг36тЏъ,5,6,10,11,20,28,36,25,37
угг37тЏъ,7,8,10,13,14,19,37,29,33
угг38тЏъ,4,14,19,22,24,29,34,8,31
угг39тЏъ,7,13,19,23,25,26,30,1,18
угг40тЏъ,2,6,11,23,26,31,34,7,20
угг41тЏъ,2,3,8,15,34,35,36,25,28
угг42тЏъ,2,15,16,17,23,31,33,8,26
угг43тЏъ,4,6,7,8,24,31,37,5,13
угг44тЏъ,3,4,6,15,27,28,29,1,14
угг45тЏъ,1,2,9,18,21,27,33,25,31
угг46тЏъ,2,5,6,15,23,27,30,4,35
угг47тЏъ,2,9,11,14,20,21,36,6,15
угг48тЏъ,3,5,24,26,29,30,34,8,35
угг49тЏъ,8,11,12,17,24,26,27,14,21
угг50тЏъ,3,4,7,8,15,24,29,11,16
угг51тЏъ,1,4,5,8,20,23,35,15,33
угг52тЏъ,8,10,22,24,26,32,34,5,9
угг53тЏъ,1,4,14,16,20,33,36,12,30
угг54тЏъ,1,3,5,10,18,22,23,7,35
угг55тЏъ,4,12,14,17,23,30,36,13,33
угг56тЏъ,4,23,26,27,28,32,36,29,30
угг57тЏъ,5,6,12,16,17,20,33,8,32
угг58тЏъ,1,6,7,8,23,32,33,11,34
угг59тЏъ,5,8,12,13,21,30,35,27,34
угг60тЏъ,3,7,9,15,16,23,34,5,33
угг61тЏъ,5,10,11,21,28,31,37,13,14
угг62тЏъ,4,10,12,15,27,32,33,9,16
угг63тЏъ,4,8,19,24,28,30,32,12,37
угг64тЏъ,4,15,16,17,20,29,36,19,26
угг65тЏъ,4,7,12,22,23,24,28,25,34
угг66тЏъ,1,11,25,28,31,33,37,3,20
угг67тЏъ,7,11,15,17,18,25,35,6,33
угг68тЏъ,2,7,13,15,24,34,35,12,23
угг69тЏъ,13,17,20,22,28,29,37,11,12
угг70тЏъ,9,10,18,21,27,33,35,4,11
угг71тЏъ,1,6,13,29,34,35,37,2,15
угг72тЏъ,11,12,18,19,20,31,32,9,21
угг73тЏъ,12,16,23,25,27,30,32,28,33
угг74тЏъ,5,13,14,15,16,24,31,9,11
угг75тЏъ,4,9,15,17,19,35,37,10,20
угг76тЏъ,4,13,18,29,32,34,36,24,33
угг77тЏъ,3,10,23,25,26,28,30,15,29
угг78тЏъ,5,6,10,14,24,28,36,7,20
угг79тЏъ,2,4,7,9,21,29,37,6,36
угг80тЏъ,2,5,10,18,21,24,27,25,34
угг81тЏъ,1,3,10,18,28,31,35,9,21
угг82тЏъ,1,3,16,20,25,27,34,18,37
угг83тЏъ,1,11,21,26,28,32,35,18,22
угг84тЏъ,8,16,23,28,29,35,36,12,37
угг85тЏъ,6,7,10,11,22,26,35,14,23
угг86тЏъ,3,10,20,21,22,26,30,24,35
угг87тЏъ,8,9,12,18,20,28,31,13,15
угг88тЏъ,3,4,10,14,25,29,30,18,19
угг89тЏъ,1,3,11,26,28,34,36,17,20
угг90тЏъ,2,8,9,13,14,18,37,11,25
угг91тЏъ,1,5,7,14,15,25,35,18,24
угг92тЏъ,4,5,15,25,26,29,32,11,27
угг93тЏъ,2,5,11,14,17,30,32,31,37
угг94тЏъ,13,19,20,27,28,29,30,26,36
угг95тЏъ,1,8,13,14,18,30,34,26,36
угг96тЏъ,9,11,14,21,22,23,24,10,36
угг97тЏъ,7,13,14,16,22,24,35,1,29
угг98тЏъ,3,9,11,13,19,25,33,10,30
угг99тЏъ,13,17,22,24,27,28,35,11,19
угг100тЏъ,1,2,11,16,25,35,36,9,14
угг101тЏъ,11,12,21,23,28,36,37,3,16
угг102тЏъ,1,4,8,27,28,29,31,13,25
угг103тЏъ,2,3,11,12,22,35,36,30,34
угг104тЏъ,7,9,11,15,16,22,37,12,13
угг105тЏъ,3,15,19,20,26,28,33,17,21
угг106тЏъ,6,10,12,19,21,22,30,1,11
угг107тЏъ,3,8,9,13,17,27,33,29,31
угг108тЏъ,2,6,7,8,28,30,36,18,21
угг109тЏъ,6,17,20,21,24,30,32,7,23
угг110тЏъ,4,12,22,30,31,35,36,19,37
угг111тЏъ,7,8,9,24,28,30,33,1,34
угг112тЏъ,6,7,10,15,27,35,36,13,20
угг113тЏъ,4,6,7,9,15,17,37,14,20
угг114тЏъ,8,13,26,27,28,29,37,4,12
угг115тЏъ,6,8,13,14,20,25,27,24,26
угг116тЏъ,9,14,23,27,28,31,32,3,20
угг117тЏъ,9,10,20,28,31,34,37,23,26
угг118тЏъ,5,8,9,24,27,28,30,16,20
угг119тЏъ,3,6,8,14,15,25,36,24,35
угг120тЏъ,2,16,18,26,32,35,37,9,36
угг121тЏъ,2,4,13,16,21,30,37,19,29
угг122тЏъ,2,16,18,26,27,34,35,5,12
угг123тЏъ,1,3,5,8,29,34,36,23,28
угг124тЏъ,1,2,15,17,18,22,36,6,27
угг125тЏъ,1,6,11,14,19,28,35,18,21
угг126тЏъ,4,10,13,16,17,21,27,1,18
угг127тЏъ,10,12,15,23,28,30,35,6,25
угг128тЏъ,2,4,8,23,26,27,32,3,35
угг129тЏъ,5,7,11,19,24,27,30,29,35
угг130тЏъ,1,15,20,23,25,31,32,5,24
угг131тЏъ,3,4,12,17,32,34,36,23,31
угг132тЏъ,7,10,14,16,20,30,31,35,37
угг133тЏъ,3,7,13,15,17,21,30,14,27
угг134тЏъ,4,9,20,28,30,34,35,12,29
угг135тЏъ,8,9,13,14,24,32,34,3,4
угг136тЏъ,10,17,24,27,30,33,37,18,31
угг137тЏъ,13,19,21,25,27,32,35,16,20
угг138тЏъ,2,5,17,20,21,32,33,30,35
угг139тЏъ,9,16,18,21,23,34,35,4,36
угг140тЏъ,3,11,12,13,17,26,35,1,33
угг141тЏъ,2,10,18,30,31,32,36,21,29
угг142тЏъ,6,12,14,18,21,27,28,1,33
угг143тЏъ,1,3,8,14,28,29,33,4,31
угг144тЏъ,2,9,13,18,22,32,36,17,26
угг145тЏъ,10,12,18,28,29,30,35,4,19
угг146тЏъ,4,10,25,27,28,33,34,15,35
угг147тЏъ,1,5,7,12,15,24,25,8,14
угг148тЏъ,1,9,11,16,20,30,34,12,33
угг149тЏъ,1,4,15,19,22,23,31,12,32
угг150тЏъ,6,7,14,20,27,31,34,11,24
угг151тЏъ,9,10,13,15,21,22,24,4,8
угг152тЏъ,8,12,17,21,23,24,31,6,7
угг153тЏъ,7,9,10,16,20,28,37,2,33
угг154тЏъ,2,4,19,21,24,28,35,3,13
угг155тЏъ,2,9,13,18,22,24,26,10,37
угг156тЏъ,4,9,16,19,22,33,34,17,36
угг157тЏъ,5,9,16,26,28,29,32,1,37
угг158тЏъ,3,6,7,30,32,36,37,5,20
угг159тЏъ,10,14,17,21,23,27,31,16,24
угг160тЏъ,1,2,8,24,32,36,37,23,33
угг161тЏъ,8,14,17,18,20,22,34,4,30
угг162тЏъ,2,7,8,12,14,23,27,6,10
угг163тЏъ,1,2,6,16,28,30,31,3,7
угг164тЏъ,3,13,20,23,31,35,36,2,11
угг165тЏъ,9,11,14,15,16,18,27,6,20
угг166тЏъ,14,20,27,29,30,31,37,23,34
угг167тЏъ,1,3,5,7,10,26,36,19,37
угг168тЏъ,3,9,12,14,19,20,36,2,5
угг169тЏъ,1,5,10,20,21,28,30,25,26
угг170тЏъ,3,5,6,9,27,32,36,12,24
угг171тЏъ,1,2,6,21,23,27,28,11,16
угг172тЏъ,5,20,21,27,30,31,36,9,26
угг173тЏъ,7,9,19,22,24,27,30,4,28
угг174тЏъ,10,13,14,15,23,31,32,4,29
угг175тЏъ,6,17,21,31,33,35,37,14,18
угг176тЏъ,1,11,12,17,22,30,35,15,16
угг177тЏъ,9,15,19,23,25,34,36,2,35
угг178тЏъ,6,9,11,15,26,34,36,13,37
угг179тЏъ,4,9,12,13,22,26,36,5,33
угг180тЏъ,1,8,11,21,23,25,28,5,37
угг181тЏъ,7,8,10,13,19,23,24,15,27
угг182тЏъ,1,7,10,11,20,23,30,3,37
угг183тЏъ,6,15,20,26,33,34,37,19,29
угг184тЏъ,7,14,18,22,23,26,34,2,32
угг185тЏъ,1,2,4,16,26,29,34,11,12
угг186тЏъ,5,14,16,19,31,33,37,21,28
угг187тЏъ,4,6,10,23,24,32,36,15,31
угг188тЏъ,6,15,19,25,26,30,31,14,18
угг189тЏъ,3,7,8,10,18,23,35,1,19
угг190тЏъ,2,11,12,18,21,33,36,8,34
угг191тЏъ,8,15,21,24,26,27,29,7,30
угг192тЏъ,12,13,14,19,25,33,34,3,22
угг193тЏъ,4,6,20,21,22,24,31,9,10
угг194тЏъ,3,6,27,30,31,32,36,14,23
угг195тЏъ,4,7,12,20,23,24,31,26,35
угг196тЏъ,7,13,15,25,30,32,37,8,14
угг197тЏъ,6,8,10,12,16,21,28,14,23
угг198тЏъ,18,21,31,32,33,36,37,5,25
угг199тЏъ,1,9,17,20,22,28,29,13,16
угг200тЏъ,13,14,17,21,27,28,34,1,11
угг201тЏъ,8,11,17,24,28,31,32,12,34
угг202тЏъ,3,7,11,16,22,34,37,29,32
угг203тЏъ,6,13,17,22,32,33,36,12,28
угг204тЏъ,5,19,20,21,30,34,36,7,12
угг205тЏъ,4,5,19,31,35,36,37,27,32
угг206тЏъ,1,6,7,11,27,35,36,22,26
угг207тЏъ,4,5,10,13,28,32,33,19,26
угг208тЏъ,4,13,16,18,22,26,33,27,29
угг209тЏъ,3,4,6,13,22,31,36,28,34
угг210тЏъ,2,4,6,11,15,19,36,23,34
угг211тЏъ,7,15,22,25,31,32,35,29,36
угг212тЏъ,4,6,10,19,20,24,29,1,27
угг213тЏъ,5,13,15,18,19,24,35,20,23
угг214тЏъ,2,6,9,12,31,36,37,3,22
угг215тЏъ,11,12,13,21,29,36,37,7,9
угг216тЏъ,9,14,22,24,25,36,37,8,28
угг217тЏъ,4,6,26,27,28,35,36,24,34
угг218тЏъ,15,16,17,21,26,29,30,10,34
угг219тЏъ,6,9,13,14,21,25,31,2,4
угг220тЏъ,7,9,11,18,25,28,35,20,27
угг221тЏъ,1,2,9,11,17,30,35,13,36
угг222тЏъ,3,9,18,21,23,27,29,35,37
угг223тЏъ,10,13,19,21,26,33,34,24,25
угг224тЏъ,2,4,7,10,12,29,34,1,21
угг225тЏъ,13,15,17,18,20,21,26,25,29
угг226тЏъ,12,17,21,24,26,30,32,10,22
угг227тЏъ,2,3,7,9,22,23,26,29,30
угг228тЏъ,6,11,14,21,24,28,31,22,36
угг229тЏъ,2,3,9,30,33,36,37,1,32
угг230тЏъ,3,5,8,15,22,25,27,18,31
угг231тЏъ,4,15,18,24,25,34,36,10,26
угг232тЏъ,2,4,7,9,15,35,37,10,23
угг233тЏъ,3,13,17,25,26,27,29,8,37
угг234тЏъ,7,14,15,16,23,25,30,5,34
угг235тЏъ,2,9,13,18,21,33,34,3,11
угг236тЏъ,19,22,23,34,35,36,37,10,30
угг237тЏъ,3,4,7,19,20,21,29,8,33
угг238тЏъ,3,21,26,33,34,35,37,23,31
угг239тЏъ,8,13,17,21,23,28,37,1,14
угг240тЏъ,9,12,14,24,29,31,35,5,30
угг241тЏъ,5,11,12,19,21,26,28,4,20
угг242тЏъ,1,5,13,17,31,32,35,19,24
угг243тЏъ,6,9,13,18,20,22,30,11,14
угг244тЏъ,2,9,17,22,32,34,36,11,12
угг245тЏъ,2,8,9,11,24,26,27,7,36
угг246тЏъ,3,6,9,19,23,25,31,21,36
угг247тЏъ,10,12,13,16,34,35,36,11,37
угг248тЏъ,1,5,6,22,25,27,31,12,18
угг249тЏъ,9,20,28,29,31,34,37,5,25
угг250тЏъ,5,9,10,13,26,30,34,18,23
угг251тЏъ,1,15,20,26,28,34,37,23,30
угг252тЏъ,8,23,24,25,27,30,31,11,17
угг253тЏъ,6,7,9,12,15,17,24,26,29
угг254тЏъ,1,12,14,18,23,24,31,7,26
угг255тЏъ,1,4,11,13,15,21,32,5,10
угг256тЏъ,14,21,24,27,30,33,37,19,20
угг257тЏъ,5,15,16,26,27,32,35,23,28
угг258тЏъ,1,3,11,20,23,32,35,25,26
угг259тЏъ,5,6,15,19,22,29,32,4,31
угг260тЏъ,4,8,12,23,29,31,34,5,6
угг261тЏъ,4,14,15,17,21,23,26,7,8
угг262тЏъ,2,6,7,9,19,23,36,5,15
угг263тЏъ,1,5,11,16,27,35,36,6,14
угг264тЏъ,8,13,15,17,21,26,29,4,24
угг265тЏъ,12,13,15,19,21,24,36,10,37
угг266тЏъ,6,11,15,17,20,27,32,16,22
угг267тЏъ,8,13,18,20,23,25,26,6,28
угг268тЏъ,4,5,9,15,29,31,33,26,27
угг269тЏъ,1,9,15,24,31,33,36,2,26
угг270тЏъ,1,2,11,13,15,24,25,26,28
угг271тЏъ,1,9,15,16,19,32,35,14,31
угг272тЏъ,2,5,8,15,18,26,31,19,25
угг273тЏъ,13,15,21,23,26,32,34,5,9
угг274тЏъ,9,14,21,23,25,26,37,7,29
угг275тЏъ,8,9,15,19,24,25,35,34,37
угг276тЏъ,3,6,12,17,22,34,35,2,33
угг277тЏъ,6,7,9,11,21,23,25,1,22
угг278тЏъ,6,9,14,21,23,33,36,27,28
угг279тЏъ,7,11,15,17,19,23,31,9,37
угг280тЏъ,4,9,10,11,24,32,35,2,37
угг281тЏъ,1,2,17,19,20,22,26,30,36
угг282тЏъ,10,17,18,25,29,35,36,7,14
угг283тЏъ,13,14,15,17,23,29,31,10,19
угг284тЏъ,6,7,10,25,29,30,33,1,31
угг285тЏъ,11,15,21,26,30,34,35,4,36
угг286тЏъ,4,5,14,17,18,29,37,27,31
угг287тЏъ,2,7,10,20,24,29,34,4,8
угг288тЏъ,1,8,9,16,27,32,37,17,31
угг289тЏъ,2,7,10,12,16,17,34,23,25
угг290тЏъ,3,13,22,26,31,32,37,29,35
угг291тЏъ,1,11,18,19,21,29,37,5,15
угг292тЏъ,12,15,25,26,27,29,35,24,30
угг293тЏъ,11,13,15,20,27,29,35,1,7
угг294тЏъ,3,4,6,10,14,22,29,28,32
угг295тЏъ,4,5,6,8,9,22,32,13,26
угг296тЏъ,1,8,10,12,18,28,29,25,27
угг297тЏъ,2,3,11,16,23,28,36,8,24
угг298тЏъ,1,3,8,11,18,19,22,26,30
угг299тЏъ,1,6,10,13,16,26,36,28,30
угг300тЏъ,4,7,21,31,33,34,35,6,12
угг301тЏъ,4,11,12,25,27,30,33,5,19
угг302тЏъ,8,16,26,27,28,32,34,4,25
угг303тЏъ,4,7,14,17,21,34,37,10,30
угг304тЏъ,7,9,10,17,28,33,36,18,23
угг305тЏъ,6,17,23,24,27,28,31,10,18
угг306тЏъ,12,13,15,22,25,33,35,1,31
угг307тЏъ,5,8,15,24,25,32,35,20,26
угг308тЏъ,5,6,11,15,20,32,33,13,25
угг309тЏъ,1,7,13,14,16,21,22,18,34
угг310тЏъ,17,25,26,28,31,32,37,6,9
угг311тЏъ,9,11,18,24,26,27,37,30,33
угг312тЏъ,1,2,4,18,20,29,34,17,30
угг313тЏъ,9,13,16,23,28,29,30,1,20
угг314тЏъ,3,6,8,19,32,34,35,12,30
угг315тЏъ,3,11,18,26,30,33,37,28,31
угг316тЏъ,3,9,10,17,30,33,34,6,8
угг317тЏъ,7,8,14,15,16,20,29,18,19
угг318тЏъ,4,5,10,12,27,34,36,3,14
угг319тЏъ,2,6,14,23,28,31,35,19,27
угг320тЏъ,5,6,18,22,26,33,34,36,37
угг321тЏъ,15,24,27,28,29,34,35,9,25
угг322тЏъ,1,10,11,21,26,29,30,14,20
угг323тЏъ,11,14,15,21,26,34,36,23,27
угг324тЏъ,9,13,16,17,18,19,20,30,36
угг325тЏъ,4,14,17,18,21,31,33,6,20
угг326тЏъ,1,2,17,18,24,27,29,12,32
угг327тЏъ,1,3,13,14,16,30,31,2,17
угг328тЏъ,3,9,10,14,19,24,30,18,21
угг329тЏъ,3,10,19,20,26,28,30,15,25
угг330тЏъ,3,4,10,12,17,18,20,19,32
угг331тЏъ,5,7,11,12,15,18,20,19,30
угг332тЏъ,5,7,10,15,24,27,30,3,33
угг333тЏъ,1,4,10,11,16,24,34,30,32
угг334тЏъ,3,7,15,16,30,34,35,8,29
угг335тЏъ,9,10,17,18,22,25,35,13,14
угг336тЏъ,9,10,13,21,25,31,33,24,37
угг337тЏъ,5,7,10,12,14,24,35,11,33
угг338тЏъ,7,9,16,17,23,27,34,15,36
угг339тЏъ,11,15,18,20,23,25,32,9,37
угг340тЏъ,6,14,17,26,27,30,36,12,28
угг341тЏъ,4,11,17,27,29,31,36,19,24
угг342тЏъ,3,6,24,28,32,35,36,4,8
угг343тЏъ,17,19,22,29,30,31,32,11,16
угг344тЏъ,11,19,28,29,31,32,37,12,21
угг345тЏъ,6,9,10,18,28,31,32,24,35
угг346тЏъ,11,16,18,23,30,31,35,3,27
угг347тЏъ,3,6,11,13,18,20,34,25,35
угг348тЏъ,2,5,17,18,19,20,33,1,24
угг349тЏъ,4,10,11,15,18,22,34,16,32
угг350тЏъ,10,19,21,23,24,30,37,2,28
угг351тЏъ,8,13,17,19,23,25,28,5,16
угг352тЏъ,3,4,14,18,26,30,32,28,34
угг353тЏъ,11,15,22,23,24,29,33,19,34
угг354тЏъ,1,2,8,10,13,25,31,23,35
угг355тЏъ,4,6,9,10,23,27,33,14,31
угг356тЏъ,4,16,20,30,33,34,36,19,21
угг357тЏъ,5,8,12,13,14,24,30,27,35
угг358тЏъ,5,13,14,26,32,33,34,8,11
угг359тЏъ,4,7,11,17,19,26,35,1,24
угг360тЏъ,9,11,13,14,20,22,37,15,17
угг361тЏъ,5,9,16,20,29,33,35,2,8
угг362тЏъ,4,7,8,14,22,24,27,13,26
угг363тЏъ,13,15,17,22,26,34,36,3,19
угг364тЏъ,3,9,10,14,16,20,27,19,33
угг365тЏъ,1,4,13,14,16,22,35,10,23
угг366тЏъ,10,24,25,26,27,33,36,4,23
угг367тЏъ,8,14,19,20,29,30,31,7,35
угг368тЏъ,7,8,9,13,21,34,35,3,20
угг369тЏъ,1,7,9,11,15,31,34,6,33
угг370тЏъ,7,10,16,25,26,33,34,24,35
угг371тЏъ,1,3,4,8,11,21,25,12,23
угг372тЏъ,6,8,22,23,32,33,36,9,27
угг373тЏъ,2,3,17,18,22,23,31,4,30
угг374тЏъ,4,5,9,10,18,27,35,15,34
угг375тЏъ,13,15,18,19,23,27,32,34,35
угг376тЏъ,6,11,14,17,23,31,37,10,15
угг377тЏъ,6,7,10,17,25,33,36,27,32
угг378тЏъ,1,5,9,10,14,15,29,20,28
угг379тЏъ,3,8,15,22,24,29,35,18,26
угг380тЏъ,8,14,24,25,32,34,36,13,16
угг381тЏъ,4,8,25,26,27,31,32,9,22
угг382тЏъ,2,3,5,8,19,22,37,16,28
угг383тЏъ,8,11,15,22,26,28,30,10,20
угг384тЏъ,3,7,15,18,26,30,31,9,33
угг385тЏъ,4,12,14,24,29,34,35,5,15
угг386тЏъ,9,19,22,32,35,36,37,7,21
угг387тЏъ,3,7,13,22,30,32,37,14,15
угг388тЏъ,1,6,8,10,18,21,32,13,28
угг389тЏъ,1,6,11,13,18,24,27,17,23
угг390тЏъ,3,6,19,21,23,26,27,30,34
угг391тЏъ,10,23,27,32,33,35,37,24,26
угг392тЏъ,1,4,6,15,20,22,26,18,21
угг393тЏъ,7,14,15,22,27,30,31,9,32
угг394тЏъ,6,10,22,23,27,32,33,8,19
угг395тЏъ,1,2,5,20,26,29,32,8,9
угг396тЏъ,2,3,5,8,16,20,34,26,31
угг397тЏъ,4,12,13,15,21,28,37,7,20
угг398тЏъ,3,4,10,17,20,22,33,1,6
угг399тЏъ,7,15,19,20,21,33,36,4,10
угг400тЏъ,4,17,22,28,30,31,35,25,34
угг401тЏъ,4,5,9,14,18,30,35,1,33
угг402тЏъ,7,9,12,17,20,26,29,4,13
угг403тЏъ,2,6,8,12,19,20,29,5,26
угг404тЏъ,4,8,13,16,25,30,32,9,26
угг405тЏъ,3,10,16,17,24,32,36,11,29
угг406тЏъ,1,2,5,16,18,21,29,24,25
угг407тЏъ,19,21,25,26,28,30,31,9,16
угг408тЏъ,16,18,19,21,29,30,35,14,28
угг409тЏъ,13,15,16,24,30,31,37,12,33
угг410тЏъ,1,2,18,21,26,29,37,9,36
угг411тЏъ,4,11,12,21,23,27,36,9,14
угг412тЏъ,14,20,22,29,31,33,34,15,24
угг413тЏъ,3,10,16,18,19,34,35,27,36
угг414тЏъ,3,8,16,21,25,36,37,14,20
угг415тЏъ,4,8,12,13,23,32,37,16,35
угг416тЏъ,8,9,10,15,16,30,31,29,36
угг417тЏъ,4,5,13,18,23,27,32,9,11
угг418тЏъ,10,13,17,18,22,28,37,1,30
угг419тЏъ,3,11,14,21,26,29,34,22,33
угг420тЏъ,4,5,11,13,24,32,34,2,3
угг421тЏъ,9,15,18,26,28,32,37,21,36
угг422тЏъ,1,9,21,23,30,35,36,5,6
угг423тЏъ,1,7,9,11,29,31,32,2,6
угг424тЏъ,5,6,12,19,25,30,35,26,33
угг425тЏъ,2,9,14,20,22,34,35,7,24
угг426тЏъ,1,2,6,8,30,31,33,13,35
угг427тЏъ,11,13,26,27,31,33,37,9,18
угг428тЏъ,3,6,16,22,31,34,35,24,32
угг429тЏъ,6,11,14,27,30,32,35,18,24
угг430тЏъ,2,12,17,24,28,30,32,3,27
угг431тЏъ,7,11,12,17,19,20,26,2,3
угг432тЏъ,5,10,13,24,29,30,35,21,31
угг433тЏъ,14,17,20,25,32,33,36,10,34
угг434тЏъ,10,11,12,17,29,34,37,26,30
угг435тЏъ,3,5,7,11,15,17,25,13,32
угг436тЏъ,5,6,21,22,26,31,32,18,36
угг437тЏъ,8,10,14,15,23,25,26,1,11
угг438тЏъ,4,13,16,21,32,34,37,27,33
угг439тЏъ,1,3,6,9,26,29,31,14,18
угг440тЏъ,5,10,17,18,19,22,32,14,35
угг441тЏъ,15,21,22,23,27,28,37,8,25
угг442тЏъ,6,13,14,16,19,30,32,25,36
угг443тЏъ,1,5,8,26,28,32,36,23,24
угг444тЏъ,11,15,16,17,18,27,29,25,33
угг445тЏъ,4,22,25,27,28,30,33,2,3
угг446тЏъ,1,7,9,12,15,29,32,11,28
угг447тЏъ,3,5,8,13,26,30,37,25,28
угг448тЏъ,7,21,24,29,32,36,37,22,27
угг449тЏъ,2,21,26,27,32,33,34,8,9
угг450тЏъ,2,7,12,15,21,23,30,9,31
угг451тЏъ,2,15,22,25,28,33,37,10,17
угг452тЏъ,5,17,20,21,31,34,35,8,27
угг453тЏъ,2,8,10,21,24,26,35,9,13
угг454тЏъ,8,17,21,26,27,29,31,1,33
угг455тЏъ,1,5,8,15,18,26,36,33,34
угг456тЏъ,9,15,17,18,22,25,31,33,36
угг457тЏъ,7,14,19,27,31,35,36,9,33
угг458тЏъ,7,11,12,14,19,21,33,6,37
угг459тЏъ,2,4,7,8,10,20,29,14,33
угг460тЏъ,5,6,9,23,27,28,30,4,13
угг461тЏъ,2,13,19,22,32,35,37,14,33
угг462тЏъ,7,11,24,27,29,34,35,4,18
угг463тЏъ,3,7,13,16,19,24,30,6,10
угг464тЏъ,7,8,13,17,30,32,36,1,10
угг465тЏъ,1,4,5,13,27,31,35,15,22
угг466тЏъ,5,6,8,14,15,25,29,18,33
угг467тЏъ,7,8,11,13,14,26,30,31,34
угг468тЏъ,3,12,15,16,25,29,37,26,28
угг469тЏъ,1,6,8,13,16,30,33,23,28
угг470тЏъ,2,3,9,16,27,32,36,1,34
угг471тЏъ,3,5,7,8,11,19,34,17,32
угг472тЏъ,5,7,8,32,33,34,36,4,6
угг473тЏъ,6,11,21,24,28,33,37,8,27
угг474тЏъ,3,17,19,21,24,32,34,27,28
угг475тЏъ,1,2,22,24,26,31,37,12,19
угг476тЏъ,4,7,9,15,22,24,31,21,37
угг477тЏъ,2,5,9,19,25,32,37,7,29
угг478тЏъ,6,8,11,13,16,20,32,12,34
угг479тЏъ,8,11,13,18,24,30,31,21,23
угг480тЏъ,10,13,19,21,26,30,36,22,34
угг481тЏъ,1,10,13,14,16,25,27,5,21
угг482тЏъ,2,5,14,15,17,19,36,8,34
угг483тЏъ,2,11,20,23,25,36,37,29,34
угг484тЏъ,1,4,6,9,13,22,31,29,30
угг485тЏъ,4,6,17,20,22,24,26,8,9
угг486тЏъ,8,13,15,23,24,31,35,14,19
угг487тЏъ,9,10,13,15,26,34,37,22,36
угг488тЏъ,3,13,16,18,19,20,35,2,11
угг489тЏъ,3,6,7,15,25,29,31,8,14
угг490тЏъ,12,14,18,21,23,29,37,7,15
угг491тЏъ,3,14,17,21,22,32,35,6,30
угг492тЏъ,7,10,12,15,23,31,37,9,18
угг493тЏъ,5,13,14,20,21,25,31,9,36
угг494тЏъ,7,9,12,22,28,29,32,17,19
угг495тЏъ,2,16,19,20,22,33,36,6,32
угг496тЏъ,5,8,15,18,25,27,36,10,26
угг497тЏъ,18,20,24,26,27,30,33,17,19
угг498тЏъ,6,8,12,20,21,24,29,4,18
угг499тЏъ,5,9,14,18,27,32,34,6,12
угг500тЏъ,17,18,24,30,31,32,35,6,36
угг501тЏъ,1,2,4,7,12,14,31,30,33
угг502тЏъ,1,2,12,17,21,22,33,4,30
угг503тЏъ,5,7,8,13,23,26,33,31,37
угг504тЏъ,1,3,4,5,6,29,31,11,14
угг505тЏъ,9,10,12,15,16,28,36,1,23
угг506тЏъ,8,14,19,22,29,31,37,3,21
угг507тЏъ,4,19,25,26,30,32,36,1,15
угг508тЏъ,1,5,6,9,16,26,31,25,33
угг509тЏъ,10,14,22,26,27,32,33,20,37
угг510тЏъ,3,5,9,11,17,33,37,4,22
угг511тЏъ,1,9,14,24,28,36,37,16,31
угг512тЏъ,5,7,17,22,25,26,28,3,23
угг513тЏъ,1,4,10,13,15,19,37,16,20
угг514тЏъ,1,5,10,17,20,27,37,3,22
угг515тЏъ,3,15,17,22,26,27,28,6,8
угг516тЏъ,7,12,15,16,18,25,36,9,19
угг517тЏъ,3,6,10,16,26,29,31,7,24
угг518тЏъ,5,8,11,24,30,32,36,4,35
угг519тЏъ,1,2,8,14,17,21,34,20,26
угг520тЏъ,9,22,25,28,33,34,37,15,16
угг521тЏъ,21,24,25,27,30,33,36,3,31
угг522тЏъ,1,10,12,19,22,25,37,2,34
угг523тЏъ,3,17,19,27,28,32,35,2,34
угг524тЏъ,4,17,22,27,29,31,34,3,37
угг525тЏъ,11,14,17,18,21,25,31,1,27
угг526тЏъ,4,13,17,19,20,26,29,2,28
угг527тЏъ,4,8,12,25,27,32,34,15,17
угг528тЏъ,5,7,10,19,30,32,33,1,17
угг529тЏъ,7,9,13,14,22,26,29,10,21
угг530тЏъ,1,11,13,28,29,30,34,23,27
угг531тЏъ,4,6,9,11,14,28,30,10,12
угг532тЏъ,4,9,13,18,26,28,36,8,16
угг533тЏъ,2,4,9,11,14,25,37,29,32
угг534тЏъ,10,17,18,19,20,24,25,30,32
угг535тЏъ,5,11,12,19,29,32,36,9,26
угг536тЏъ,8,12,16,17,22,28,34,9,37
угг537тЏъ,2,3,9,13,14,35,37,4,17
угг538тЏъ,1,2,11,12,16,25,28,6,22
угг539тЏъ,4,6,8,18,20,27,35,24,26
угг540тЏъ,3,7,10,18,19,28,36,13,26
угг541тЏъ,6,14,23,25,27,28,34,19,37
угг542тЏъ,2,9,26,31,33,35,36,15,20
угг543тЏъ,2,11,13,18,23,24,36,17,26
угг544тЏъ,10,11,18,21,22,29,34,4,32
угг545тЏъ,3,12,16,17,27,30,34,15,37
угг546тЏъ,7,14,17,28,33,35,36,13,27
угг547тЏъ,4,11,14,18,23,25,29,17,32
угг548тЏъ,1,13,16,17,18,25,30,20,34
угг549тЏъ,13,19,20,28,33,34,35,4,32
угг550тЏъ,7,8,13,22,24,29,30,10,35
угг551тЏъ,15,16,17,22,29,32,37,23,24
угг552тЏъ,7,11,12,16,18,33,34,1,14
угг553тЏъ,2,6,13,15,16,20,33,9,28
угг554тЏъ,4,10,15,17,29,32,36,13,30
угг555тЏъ,9,12,17,19,26,32,34,11,22
угг556тЏъ,17,20,26,28,29,33,35,1,6
угг557тЏъ,3,5,7,10,17,18,35,2,21
угг558тЏъ,15,20,21,22,23,26,34,6,10
угг559тЏъ,3,4,10,13,15,18,22,2,16
угг560тЏъ,3,20,29,32,33,34,35,2,24
угг561тЏъ,6,8,19,20,27,32,37,13,33
угг562тЏъ,2,14,15,20,28,30,34,3,4
угг563тЏъ,1,4,6,14,16,19,31,12,18
угг564тЏъ,9,13,15,18,22,24,30,6,27
угг565тЏъ,3,6,9,11,19,30,36,1,33
угг566тЏъ,3,5,18,25,28,35,37,7,8
угг567тЏъ,6,8,16,18,19,34,37,15,30
угг568тЏъ,8,18,20,29,30,33,34,5,23
угг569тЏъ,12,15,17,22,30,34,35,5,9
угг570тЏъ,1,3,9,12,25,26,35,29,31
угг571тЏъ,13,26,27,29,30,34,37,2,23
угг572тЏъ,1,2,4,19,21,26,28,3,25
угг573тЏъ,11,12,18,19,23,26,31,15,25
угг574тЏъ,4,5,13,16,22,23,35,36,37
угг575тЏъ,2,12,18,20,25,28,30,9,23
угг576тЏъ,11,13,14,18,19,23,31,7,27
угг577тЏъ,11,13,19,25,29,36,37,18,30
угг578тЏъ,2,15,19,20,22,31,36,13,23
угг579тЏъ,7,19,23,33,34,35,36,5,10
угг580тЏъ,4,13,14,15,17,27,33,2,11
угг581тЏъ,3,8,10,15,18,23,37,17,24
угг582тЏъ,5,7,22,29,30,32,36,3,33
угг583тЏъ,1,5,8,9,20,30,37,11,26
угг584тЏъ,10,11,12,17,23,30,36,20,21
угг585тЏъ,6,11,13,14,16,27,34,12,25
угг586тЏъ,1,2,4,14,15,22,23,13,36
угг587тЏъ,15,18,21,22,23,25,32,1,30
угг588тЏъ,3,5,9,13,15,21,31,12,17
угг589тЏъ,1,6,8,9,14,29,33,5,23
угг590тЏъ,1,3,9,10,15,25,35,19,28
угг591тЏъ,4,7,8,11,21,23,35,10,24
угг592тЏъ,3,8,11,15,19,24,32,14,30
угг593тЏъ,3,8,9,14,15,22,32,1,12
угг594тЏъ,5,12,21,25,27,34,36,10,32
угг595тЏъ,14,15,16,19,25,28,33,6,29
угг596тЏъ,1,9,16,19,23,29,32,5,37
угг597тЏъ,2,4,14,15,22,27,34,1,5
угг598тЏъ,1,4,7,11,12,18,26,3,33
угг599тЏъ,4,7,16,19,26,31,33,25,29
угг600тЏъ,1,2,12,16,19,29,32,9,37
угг601тЏъ,4,8,18,20,29,35,37,19,34
угг602тЏъ,7,15,18,24,29,31,34,5,25
угг603тЏъ,4,9,10,23,28,30,34,18,31
угг604тЏъ,4,6,9,12,25,31,36,27,30
угг605тЏъ,2,8,15,26,28,31,32,19,24
угг606тЏъ,9,17,18,20,22,27,36,25,37
угг607тЏъ,12,14,20,27,31,34,37,19,21
угг608тЏъ,7,10,11,18,20,29,30,32,36
угг609тЏъ,4,11,12,23,26,32,37,1,9
угг610тЏъ,1,8,9,23,24,31,36,21,28
угг611тЏъ,7,8,11,18,20,30,34,5,14
угг612тЏъ,5,13,16,23,27,31,34,26,33
угг613тЏъ,3,5,6,10,19,21,35,13,27
угг614тЏъ,14,21,22,23,24,28,34,5,37
угг615тЏъ,4,11,21,26,27,28,33,10,13
угг616тЏъ,7,15,20,28,29,34,36,1,35
угг617тЏъ,2,6,10,12,25,28,35,27,31
угг618тЏъ,7,17,20,23,24,34,36,25,35
угг619тЏъ,8,9,18,20,27,29,32,7,12
угг620тЏъ,2,4,8,10,12,29,32,6,13
угг621тЏъ,1,2,12,13,14,30,36,9,24
угг622тЏъ,1,10,28,29,30,33,34,21,27
угг623тЏъ,9,12,22,26,28,31,37,7,30
угг624тЏъ,2,14,15,26,27,34,36,9,24
угг625тЏъ,3,10,12,18,19,24,32,4,15
угг626тЏъ,1,3,7,12,17,32,34,14,30
угг627тЏъ,9,15,21,30,33,34,37,10,35
угг628тЏъ,1,8,9,11,18,27,35,16,34
угг629тЏъ,2,7,9,21,23,24,30,22,29
угг630тЏъ,4,6,8,23,28,29,34,10,19
угг631тЏъ,2,3,6,17,33,35,36,25,37
угг632тЏъ,5,7,10,11,29,31,37,13,25
угг633тЏъ,2,5,10,17,21,31,36,20,32
угг634тЏъ,2,12,18,29,32,36,37,5,21
угг635тЏъ,10,12,20,29,30,31,34,4,15
угг636тЏъ,10,14,17,20,26,27,29,3,11
угг637тЏъ,1,4,7,8,9,20,21,11,30
угг638тЏъ,1,6,18,19,35,36,37,11,24
угг639тЏъ,5,9,12,15,30,31,34,13,29
угг640тЏъ,2,7,9,12,13,14,29,15,30
угг641тЏъ,1,3,7,23,24,33,36,17,30
угг642тЏъ,1,7,22,23,33,34,35,2,24
угг643тЏъ,1,5,15,16,18,27,34,19,22
угг644тЏъ,1,11,12,14,20,26,29,2,5
угг645тЏъ,7,10,16,20,26,32,35,24,33
угг646тЏъ,5,12,13,15,18,35,37,11,29
угг647тЏъ,4,5,9,13,17,22,28,18,31
угг648тЏъ,3,17,19,24,28,29,35,7,13
угг649тЏъ,12,22,23,26,33,35,37,2,21
угг650тЏъ,1,8,10,14,25,33,35,12,21
угг651тЏъ,2,13,19,20,24,26,35,29,36
угг652тЏъ,1,16,21,26,27,30,35,6,37
угг653тЏъ,6,7,12,25,26,30,33,13,15
угг654тЏъ,3,12,25,29,30,32,33,28,31
угг655тЏъ,4,5,12,13,24,26,33,3,14
угг656тЏъ,1,4,6,20,30,34,37,14,25
угг657тЏъ,9,11,16,23,27,29,32,6,24
угг658тЏъ,10,12,16,18,19,22,37,11,20
угг659тЏъ,2,8,9,14,27,34,36,5,18
угг660тЏъ,4,6,12,13,16,17,31,14,20
угг661тЏъ,7,12,17,22,31,34,35,20,32
угг662тЏъ,4,14,15,21,22,24,37,5,20
угг663тЏъ,4,6,10,11,13,17,23,25,32
угг664тЏъ,3,6,8,14,21,22,31,17,37
угг665тЏъ,6,8,14,19,22,25,35,12,17`;
        document.getElementById('csvData').value = initialRawData;

        // сѓ░сЃГсЃ╝сЃљсЃФтцЅТЋ░
        let numberFrequencies = Array(38).fill(0); 
        let currentIntervals = Array(38).fill(0); 
        let totalDraws = 0;
        
        // сЃљсЃЃсѓ»сЃєсѓ╣сЃѕуће
        let testTargetDraw = null;
        let testTargetBonus = [];

        // ух▒УеѕсЃЄсЃ╝сѓ┐сЂесЃЌсЃГсЃЋсѓАсѓцсЃФ№╝ѕт╣│тЮЄсЂеТеЎТ║ќтЂЈти«№╝Ѕ
        let statsData = {
            lastDraw: [],        
            lastSum: 0,
            coMatrix: [], 
            momentumMap: [], 
            decadeProb: {}, 
            exp: {
                sum: { mean: 130, std: 25 },
                odd: { mean: 3.5, std: 1.2 },
                consec: { mean: 0.8, std: 0.8 },
                pull: { mean: 1.2, std: 1.0 },
                intSum: { mean: 40, std: 15 },
                intStd: { mean: 8, std: 4 },
                coScore: { mean: 20, std: 5 },
                momentum: { mean: 0, std: 1 },
                adjPull: { mean: 1.5, std: 1.0 }, 
                decade: { mean: 0.05, std: 0.02 },
                block: { mean: 4.5, std: 0.8 } 
            },
            // тѕЮТюЪжЄЇсЂ┐
            weights: { sum: 150, odd: 150, consec: 200, pull: 150, int: 100, intStd: 100, coScore: 150, momentum: 100, adj: 100, dec: 100, block: 100 },
            // сЃюсЃфсЃЦсЃ╝сЃасѓЙсЃ╝сЃ│сЂ«сѓ┐сЃ╝сѓ▓сЃЃсЃѕ№╝ѕтЪ║уцјсѓ╣сѓ│сѓбсЂ«т╣│тЮЄсЂеТеЎТ║ќтЂЈти«№╝Ѕ
            histMean: 8500,
            histStd: 500
        };

        // DOMУдЂу┤а
        const elements = {
            csvData: document.getElementById('csvData'),
            includeBonus: document.getElementById('includeBonus'),
            btnMockData: document.getElementById('btnMockData'),
            btnAnalyze: document.getElementById('btnAnalyze'),
            analysisSection: document.getElementById('analysisSection'),
            analysisTitle: document.getElementById('analysisTitle'),
            hotNumbers: document.getElementById('hotNumbers'),
            coldNumbers: document.getElementById('coldNumbers'),
            latestDraw: document.getElementById('latestDraw'),
            simulationSection: document.getElementById('simulationSection'),
            
            bestPairs: document.getElementById('bestPairs'),
            bestDecades: document.getElementById('bestDecades'),

            aiWeightsDisplay: document.getElementById('aiWeightsDisplay'),
            histScoreSection: document.getElementById('histScoreSection'),
            scoreDistribution: document.getElementById('scoreDistribution'),
            avgHistScore: document.getElementById('avgHistScore'),
            recentHistScores: document.getElementById('recentHistScores'),

            modeRadios: document.querySelectorAll('input[name="simMode"]'),
            countModeUI: document.getElementById('countModeUI'),
            allModeUI: document.getElementById('allModeUI'),
            simCount: document.getElementById('simCount'),
            ticketCount: document.getElementById('ticketCount'),
            
            btnSimulate: document.getElementById('btnSimulate'),
            resultSection: document.getElementById('resultSection'),
            predictionResults: document.getElementById('predictionResults'),
            statisticalFeatures: document.getElementById('statisticalFeatures'),
            
            btnHelp: document.getElementById('btnHelp'),
            helpModal: document.getElementById('helpModal'),
            btnCloseHelp: document.getElementById('btnCloseHelp'),
            btnCloseHelpFooter: document.getElementById('btnCloseHelpFooter')
        };

        // сЃўсЃФсЃЌтѕХтЙА
        function openHelp() { elements.helpModal.classList.remove('hidden'); }
        function closeHelp() { elements.helpModal.classList.add('hidden'); }
        elements.btnHelp.addEventListener('click', openHelp);
        elements.btnCloseHelp.addEventListener('click', closeHelp);
        elements.btnCloseHelpFooter.addEventListener('click', closeHelp);
        elements.helpModal.addEventListener('click', (e) => { if(e.target === elements.helpModal) closeHelp(); });

        // сЃбсЃ╝сЃЅтѕЄТЏ┐
        elements.modeRadios.forEach(radio => {
            radio.addEventListener('change', (e) => {
                elements.countModeUI.classList.add('hidden');
                elements.allModeUI.classList.add('hidden');
                if (e.target.value === 'count') elements.countModeUI.classList.remove('hidden');
                else if (e.target.value === 'all') elements.allModeUI.classList.remove('hidden');
            });
        });

        function getBallColorClass(num) {
            if (num >= 1 && num <= 9) return 'ball-yellow';
            if (num >= 10 && num <= 19) return 'ball-blue';
            if (num >= 20 && num <= 29) return 'ball-red';
            if (num >= 30 && num <= 37) return 'ball-green';
            return 'bg-gray-500';
        }

        function countConsecutives(nums) {
            let count = 0;
            for(let i = 0; i < nums.length - 1; i++) {
                if(nums[i+1] - nums[i] === 1) count++;
            }
            return count;
        }

        function getOddEvenKey(nums) {
            let odd = nums.filter(n => n % 2 !== 0).length;
            return `${odd}:${7 - odd}`;
        }

        function getDecadeKey(nums) {
            let d0 = 0, d1 = 0, d2 = 0, d3 = 0;
            nums.forEach(n => {
                if (n < 10) d0++;
                else if (n < 20) d1++;
                else if (n < 30) d2++;
                else d3++;
            });
            return `${d0}:${d1}:${d2}:${d3}`;
        }

        function countAdjacent(nums, refNums) {
            if (!refNums || refNums.length === 0) return 0;
            let count = 0;
            nums.forEach(n => {
                if (refNums.includes(n - 1) || refNums.includes(n + 1)) count++;
            });
            return count;
        }

        function getBlockCover(nums) {
            let blocks = new Set();
            nums.forEach(n => {
                if (n <= 7) blocks.add(1);
                else if (n <= 14) blocks.add(2);
                else if (n <= 21) blocks.add(3);
                else if (n <= 28) blocks.add(4);
                else blocks.add(5);
            });
            return blocks.size;
        }

        function generateRandom7() {
            let available = Array.from({length: 37}, (_, i) => i + 1);
            let picked = [];
            for(let i = 0; i < 7; i++) {
                let r = Math.floor(Math.random() * available.length);
                picked.push(available[r]);
                available.splice(r, 1);
            }
            return picked.sort((a, b) => a - b);
        }

        elements.btnMockData.addEventListener('click', () => {
            let csv = [];
            for (let i = 1; i <= 300; i++) {
                let mainDraw = generateRandom7();
                let available = Array.from({length: 37}, (_, i) => i + 1).filter(n => !mainDraw.includes(n));
                let bonusDraw = [];
                for (let j = 0; j < 2; j++) {
                    let r = Math.floor(Math.random() * available.length);
                    bonusDraw.push(available[r]);
                    available.splice(r, 1);
                }
                csv.push(`угг${i}тЏъ,${mainDraw.join(',')},${bonusDraw.join(',')}`);
            }
            elements.csvData.value = csv.join('\n');
            alert('300тЏътѕєсЂ«сЃђсЃЪсЃ╝сЃЄсЃ╝сѓ┐сѓњућЪТѕљсЂЌсЂЙсЂЌсЂЪ№╝Ђ\nСИђуЋфСИІсЂ«УАїсЂїТюђТќ░тЏъсЂесЂЌсЂдТЅ▒сѓЈсѓїсЂЙсЂЎсђѓ');
        });

        // --- РўЁ ТЪћУ╗ЪсЂфТќЄтГЌтѕЌсЃЉсЃ╝сѓхсЃ╝ РўЁ ---
        function parseLoto7Line(line) {
            // сѓФсЃ│сЃъсЂЙсЂЪсЂ»уЕ║уЎйсЂДтѕєтЅ▓сЂЌсђЂТЋ░тГЌсЂ«сЂ┐ТійтЄ║
            let tokens = line.split(/[\s,]+/);
            let nums = tokens.filter(t => /^\d+$/.test(t)).map(n => parseInt(n, 10)).filter(n => n >= 1 && n <= 37);
            
            if (nums.length >= 7) {
                // ТюђтѕЮсЂ«7тђІсѓњТюгТЋ░тГЌсЂесЂЌсЂдтѕЄсѓітЄ║сЂЎ
                let mainNums = nums.slice(0, 7);
                let isSorted = true;
                // жђџтИИсђЂТюгТЋ░тГЌсЂ»ТўЄжаєсЂДУеўУ╝ЅсЂЋсѓїсЂдсЂёсѓІсЂ»сЂџсЂфсЂ«сЂДсЃЂсѓДсЃЃсѓ»
                for(let i=0; i<6; i++) { if(mainNums[i] >= mainNums[i+1]) isSorted = false; }
                if(isSorted) return nums; 
                
                // ТўЄжаєсЂўсѓЃсЂфсЂЈсЂдсѓѓсђЂсѓйсЃ╝сЃѕсЂЌсЂдУ┐ћсЂЎ№╝ѕСИЄсЂїСИђсЃљсЃЕсЃљсЃЕсЂФтЁЦтіЏсЂЋсѓїсЂЪта┤тљѕ№╝Ѕ
                let sortedMain = mainNums.sort((a, b) => a - b);
                return [...sortedMain, ...nums.slice(7)];
            }
            return null;
        }

        // --- РўЁ HuberТљЇтц▒сЃЕсѓцсѓ»сЂфсЃџсЃісЃФсЃєсѓБУеѕу«Ќ№╝ѕжђџтИИу»ётЏ▓сЂ«сѓ║сЃгсЂФсЂ»т»Џт«╣сЂФ№╝Ѕ РўЁ ---
        function getPenalty(z, weight) {
            // Zсѓ╣сѓ│сѓб(ТеЎТ║ќтЂЈти«сЂІсѓЅсЂ«сѓ║сЃг)сЂ«ухХт»ЙтђцсЂФт┐юсЂўсЂЪсЃџсЃісЃФсЃєсѓБ
            if (z <= 1.0) return 0; // 1¤Ѓ№╝ѕт╣│тЮЄуџё№╝ЅсЂЙсЂДсЂ»сђїС║║жќЊтЉ│сЃ╗жЂЕт║дсЂфУЇњсѓїсђЇсЂесЂЌсЂдуёАуйф
            if (z <= 2.0) return (z - 1.0) * weight * 0.5; // 1¤Ѓсђю2¤ЃсЂ»уиџтйбсЂФсЃъсѓцсЃФсЃЅТИЏуѓ╣
            // 2.0¤ЃсѓњУХЁсЂѕсѓІуЋ░тИИтђц№╝ѕтю░жЏи№╝ЅсЂ»С║їТгАжќбТЋ░сЂДуа┤тБіуџёсЃџсЃісЃФсЃєсѓБ
            return (1.0 * weight * 0.5) + Math.pow(z - 2.0, 2) * weight; 
        }

        function extractFeatures(draw, model) {
            let sum = 0, oddCount = 0, pullCount = 0, consecCount = 0;
            let intervals = [], momentumSum = 0, coScore = 0;

            for (let i = 0; i < 7; i++) {
                let n = draw[i];
                sum += n;
                if (n % 2 !== 0) oddCount++;
                if (model.lastDraw && model.lastDraw.includes(n)) pullCount++;
                
                intervals.push(model.intervals ? model.intervals[n] : 0);
                momentumSum += model.momentumMap ? model.momentumMap[n] : 0;
                
                if (i < 6 && draw[i+1] - n === 1) consecCount++;
                
                if (model.coMatrix) {
                    for (let j = i + 1; j < 7; j++) coScore += model.coMatrix[n][draw[j]];
                }
            }
            
            let intSum = intervals.reduce((a,b)=>a+b, 0);
            let intMean = intSum / 7;
            let intStd = Math.sqrt(intervals.reduce((a,b)=>a+Math.pow(b-intMean,2), 0)/7);

            let adjCount = countAdjacent(draw, model.lastDraw);
            let decKey = getDecadeKey(draw);
            let p_dec = model.decadeProb ? (model.decadeProb[decKey] || 0) : 0;
            let blockCover = getBlockCover(draw);

            // ућЪсЂ«Zсѓ╣сѓ│сѓб№╝ѕухХт»Йтђц№╝ЅсѓњУ┐ћсЂЎ
            let zSum = Math.abs(sum - model.exp.sum.mean) / Math.max(model.exp.sum.std, 1.0);
            let zOdd = Math.abs(oddCount - model.exp.odd.mean) / Math.max(model.exp.odd.std, 0.5);
            let zConsec = Math.abs(consecCount - model.exp.consec.mean) / Math.max(model.exp.consec.std, 0.5);
            let zPull = Math.abs(pullCount - model.exp.pull.mean) / Math.max(model.exp.pull.std, 0.5);
            let zInt = Math.abs(intSum - model.exp.intSum.mean) / Math.max(model.exp.intSum.std, 1.0);
            let zIntStd = Math.abs(intStd - model.exp.intStd.mean) / Math.max(model.exp.intStd.std, 0.5);
            let zCoScore = Math.abs(coScore - model.exp.coScore.mean) / Math.max(model.exp.coScore.std, 1.0);
            let zMomentum = Math.abs(momentumSum - model.exp.momentum.mean) / Math.max(model.exp.momentum.std, 0.5);
            let zAdj = Math.abs(adjCount - model.exp.adjPull.mean) / Math.max(model.exp.adjPull.std, 0.5);
            let zDec = Math.abs(p_dec - model.exp.decade.mean) / Math.max(model.exp.decade.std, 0.01);
            let zBlock = Math.abs(blockCover - model.exp.block.mean) / Math.max(model.exp.block.std, 0.5);

            return { sum: zSum, odd: zOdd, consec: zConsec, pull: zPull, int: zInt, intStd: zIntStd, coScore: zCoScore, momentum: zMomentum, adj: zAdj, dec: zDec, block: zBlock,
                raw: { sum, oddCount, pullCount, consecCount, intSum }
            };
        }

        // тЪ║уцјсѓ╣сѓ│сѓбУеѕу«Ќ№╝ѕHuberсЃЈсѓцсЃќсЃфсЃЃсЃЅсЃџсЃісЃФсЃєсѓБ№╝Ѕ
        function calcRawScore(draw, model, weights) {
            let f = extractFeatures(draw, model);
            let score = 10000;
            let keys = Object.keys(weights);
            for(let k of keys) {
                // ућЪсЂ«Zсѓ╣сѓ│сѓбсѓњТИАсЂЌсђЂHuberТљЇтц▒жќбТЋ░сЂДсЃџсЃісЃФсЃєсѓБсѓњУеѕу«ЌсЂЌсЂдт╝ЋсЂЈ
                score -= getPenalty(f[k], weights[k]);
            }
            return { score: score, ...f.raw };
        }

        function trainWeights(validLines, tempModel) {
            let dummyData = [];
            for(let i=0; i<1000; i++) dummyData.push(generateRandom7());

            let targetLines = validLines.slice(-150).map(line => line.slice(0,7).sort((a,b)=>a-b));
            let keys = ['sum', 'odd', 'consec', 'pull', 'int', 'intStd', 'coScore', 'momentum', 'adj', 'dec', 'block'];
            
            let trueFeatures = {}; let dummyFeatures = {};
            keys.forEach(k => { trueFeatures[k] = []; dummyFeatures[k] = []; });

            targetLines.forEach(d => {
                let f = extractFeatures(d, tempModel);
                keys.forEach(k => trueFeatures[k].push(getPenalty(f[k], 1))); 
            });
            dummyData.forEach(d => {
                let f = extractFeatures(d, tempModel);
                keys.forEach(k => dummyFeatures[k].push(getPenalty(f[k], 1)));
            });

            let scores = {};
            let totalScore = 0;
            
            keys.forEach(k => {
                let tMean = trueFeatures[k].reduce((a,b)=>a+b,0) / targetLines.length;
                let dMean = dummyFeatures[k].reduce((a,b)=>a+b,0) / dummyData.length;
                let tVar = trueFeatures[k].reduce((a,b)=>a+Math.pow(b-tMean,2),0) / targetLines.length;
                let dVar = dummyFeatures[k].reduce((a,b)=>a+Math.pow(b-dMean,2),0) / dummyData.length;
                
                let diff = Math.max(0.001, dMean - tMean); 
                let denominator = Math.sqrt(tVar + dVar) || 1;
                
                scores[k] = Math.log1p(diff / denominator);
                totalScore += scores[k];
            });

            let bestWeights = {};
            keys.forEach(k => {
                let ratio = totalScore > 0 ? (scores[k] / totalScore) : (1/keys.length);
                // жЄЇсЂ┐сЂ«сѓ╣сѓ▒сЃ╝сЃФсѓњсЃъсѓцсЃФсЃЅсЂФУф┐ТЋ┤
                bestWeights[k] = 30 + (ratio * 1200); 
            });

            return bestWeights;
        }

        function calculateStatsModel(lines, includeBonus) {
            let nFreq = Array(38).fill(0);
            let freqShort = Array(38).fill(0); 
            let freqMid = Array(38).fill(0);   
            let freqLong = Array(38).fill(0);  
            let tDraws = 0;
            
            let coMatrix = Array.from({length: 38}, () => Array(38).fill(0));
            let decadeCounts = {};
            
            let sums = [], odds = [], consecs = [], pulls = [], intSums = [], intStds = [], coScores = [], momentums = [];
            let decProbs = [], adjPulls = [], blockCovers = [];
            
            let tempIntervals = Array(38).fill(0); 
            let pDraw = null;

            let wShort = Math.min(5, lines.length);
            let wMid = Math.min(15, lines.length);
            let wLong = Math.min(50, lines.length);
            
            lines.slice(-wShort).forEach(nums => nums.slice(0, 7).forEach(n => freqShort[n]++));
            lines.slice(-wMid).forEach(nums => nums.slice(0, 7).forEach(n => freqMid[n]++));
            lines.slice(-wLong).forEach(nums => nums.slice(0, 7).forEach(n => freqLong[n]++));
            
            lines.forEach(nums => {
                let mainNums = nums.slice(0, 7);
                for (let i = 0; i < mainNums.length; i++) { nFreq[mainNums[i]]++; }
                
                for(let i=0; i<mainNums.length; i++) {
                    for(let j=i+1; j<mainNums.length; j++) {
                        coMatrix[mainNums[i]][mainNums[j]]++;
                        coMatrix[mainNums[j]][mainNums[i]]++;
                    }
                }
                
                let decKey = getDecadeKey(mainNums);
                decadeCounts[decKey] = (decadeCounts[decKey] || 0) + 1;
                tDraws++;
            });
            
            let decadeProb = {};
            for(let k in decadeCounts) decadeProb[k] = decadeCounts[k] / tDraws;

            let momentumMap = Array(38).fill(0);
            for(let i=1; i<=37; i++) {
                let pShort = freqShort[i] / wShort;
                let pMid = freqMid[i] / wMid;
                let pAll = nFreq[i] / tDraws;
                momentumMap[i] = (pShort - pMid) * 1.5 + (pMid - pAll);
            }

            lines.forEach(nums => {
                let mainNums = nums.slice(0, 7);
                
                sums.push(mainNums.reduce((a,b)=>a+b, 0));
                odds.push(mainNums.filter(n => n%2 !== 0).length);
                consecs.push(countConsecutives(mainNums));
                blockCovers.push(getBlockCover(mainNums));
                decProbs.push(decadeProb[getDecadeKey(mainNums)] || 0);
                
                if (pDraw !== null) {
                    pulls.push(mainNums.filter(n => pDraw.includes(n)).length);
                    adjPulls.push(countAdjacent(mainNums, pDraw));
                }
                
                let invs = mainNums.map(n => tempIntervals[n]);
                let iSum = invs.reduce((a,b)=>a+b,0);
                intSums.push(iSum);
                let iMean = iSum/7;
                intStds.push(Math.sqrt(invs.reduce((a,b)=>a+Math.pow(b-iMean,2),0)/7));
                
                let cScore = 0;
                for(let i=0; i<mainNums.length; i++) {
                    for(let j=i+1; j<mainNums.length; j++) cScore += coMatrix[mainNums[i]][mainNums[j]];
                }
                coScores.push(cScore);
                momentums.push(mainNums.reduce((acc, n) => acc + momentumMap[n], 0));
                
                for(let i=1; i<=37; i++) {
                    if (mainNums.includes(i)) tempIntervals[i] = 0;
                    else tempIntervals[i]++;
                }
                pDraw = mainNums;
            });

            const calcMean = arr => arr.length ? arr.reduce((a,b)=>a+b,0)/arr.length : 0;
            const calcStd = (arr, mean) => arr.length ? Math.sqrt(arr.reduce((a,b)=>a+Math.pow(b-mean,2),0)/arr.length) || 0 : 0;

            let exp = {
                sum: { mean: calcMean(sums), std: calcStd(sums, calcMean(sums)) },
                odd: { mean: calcMean(odds), std: calcStd(odds, calcMean(odds)) },
                consec: { mean: calcMean(consecs), std: calcStd(consecs, calcMean(consecs)) },
                pull: { mean: calcMean(pulls), std: calcStd(pulls, calcMean(pulls)) },
                intSum: { mean: calcMean(intSums), std: calcStd(intSums, calcMean(intSums)) },
                intStd: { mean: calcMean(intStds), std: calcStd(intStds, calcMean(intStds)) },
                coScore: { mean: calcMean(coScores), std: calcStd(coScores, calcMean(coScores)) },
                momentum: { mean: calcMean(momentums), std: calcStd(momentums, calcMean(momentums)) },
                adjPull: { mean: calcMean(adjPulls), std: calcStd(adjPulls, calcMean(adjPulls)) },
                decade: { mean: calcMean(decProbs), std: calcStd(decProbs, calcMean(decProbs)) },
                block: { mean: calcMean(blockCovers), std: calcStd(blockCovers, calcMean(blockCovers)) }
            };

            return { nFreq, tDraws, lastDraw: pDraw, coMatrix, momentumMap, decadeProb, intervals: tempIntervals, exp: exp };
        }

        function applyModelToGlobals(model) {
            numberFrequencies = model.nFreq;
            totalDraws = model.tDraws;
            currentIntervals = model.intervals;
            statsData.lastDraw = model.lastDraw;
            statsData.coMatrix = model.coMatrix;
            statsData.momentumMap = model.momentumMap;
            statsData.decadeProb = model.decadeProb;
            statsData.exp = model.exp;
            statsData.weights = model.weights || statsData.weights;
            statsData.histMean = model.histMean || statsData.histMean;
            statsData.histStd = model.histStd || statsData.histStd;
        }

        elements.btnAnalyze.addEventListener('click', () => {
            const rawData = elements.csvData.value.trim();
            const includeBonus = elements.includeBonus.checked;
            
            if (!rawData) { alert('сЃЄсЃ╝сѓ┐сЂїтЁЦтіЏсЂЋсѓїсЂдсЂёсЂЙсЂЏсѓЊсђѓ'); return; }

            elements.btnAnalyze.disabled = true;
            elements.btnAnalyze.innerHTML = `<div class="loader border-white border-top-transparent w-4 h-4 border-2"></div> <span>AIТи▒т▒цтГду┐њСИГ... (т░ЉсђЁсЂітЙЁсЂАсЂЈсЂасЂЋсЂё)</span>`;

            setTimeout(() => {
                let validLines = [];
                const lines = rawData.split('\n');
                lines.forEach(line => {
                    let nums = parseLoto7Line(line);
                    if (nums && nums.length >= 7) validLines.push(nums);
                });

                if (validLines.length < 3) { 
                    alert('ТюЅті╣сЂфсЃЄсЃ╝сѓ┐сЂїУХ│сѓісЂЙсЂЏсѓЊсђѓсЃЋсѓЕсЃ╝сЃъсЃЃсЃѕсѓњуб║УфЇсЂЌсЂдсЂЈсЂасЂЋсЂёсђѓ'); 
                    elements.btnAnalyze.disabled = false;
                    elements.btnAnalyze.innerHTML = `<span>­ЪЊі AIТи▒т▒цтГду┐њсЂесЃЄсЃ╝сѓ┐УДБТъљсѓњт«ЪУАї</span>`;
                    return; 
                }

                const analyzeMode = document.querySelector('input[name="analyzeMode"]:checked').value;
                testTargetDraw = null;
                testTargetBonus = [];

                if (analyzeMode === 'backtest') {
                    const testData = validLines.pop(); 
                    testTargetDraw = testData.slice(0, 7).sort((a, b) => a - b);
                    if (testData.length > 7) testTargetBonus = testData.slice(7);
                }

                let finalModel = calculateStatsModel(validLines, includeBonus);

                // AIУЄфти▒тГду┐њ№╝ѕFisherтѕцтѕЦТ»ћсЂФсѓѕсѓІТюђжЂЕтїќ№╝Ѕ
                let optimizedWeights = trainWeights(validLines, finalModel);
                finalModel.weights = optimizedWeights;

                // сЃљсЃЃсѓ»сЃєсѓ╣сЃѕсѓ╣сѓ│сѓбсЃфсЃ│сѓ░№╝ѕтЪ║уцјсѓ╣сѓ│сѓбсЂ«тѕєтИЃ№╝Ѕ
                let historicalScores = [];
                let totalRawScore = 0;
                if (validLines.length > 15) {
                    for (let i = 15; i < validLines.length; i++) {
                        let trainingData = validLines.slice(0, i);
                        let targetDraw = validLines[i].slice(0, 7).sort((a,b)=>a-b);
                        
                        let tempModel = calculateStatsModel(trainingData, includeBonus);
                        let evalResult = calcRawScore(targetDraw, tempModel, optimizedWeights);
                        historicalScores.push({ index: i, score: Math.round(evalResult.score), draw: targetDraw });
                        totalRawScore += evalResult.score;
                    }
                }

                // сѓ┐сЃ╝сѓ▓сЃЃсЃѕсЂесЂфсѓІсЃюсЃфсЃЦсЃ╝сЃасѓЙсЃ╝сЃ│№╝ѕHuberТљЇтц▒сЂФсѓѕсѓі8000~9000сЂФжЏєсЂЙсѓІсЂ»сЂџ№╝Ѕ
                let histMean = historicalScores.length > 0 ? totalRawScore / historicalScores.length : 8500;
                let histVar = 0;
                historicalScores.forEach(s => histVar += Math.pow(s.score - histMean, 2));
                let histStd = historicalScores.length > 0 ? Math.max(Math.sqrt(histVar / historicalScores.length), 100) : 500;

                finalModel.histMean = histMean;
                finalModel.histStd = histStd;

                applyModelToGlobals(finalModel);

                displayAnalysis();
                displayHistoricalScores(historicalScores);
                displayAIWeights(optimizedWeights);

                elements.analysisSection.classList.remove('hidden');
                elements.simulationSection.classList.remove('hidden');
                elements.resultSection.classList.add('hidden');

                elements.btnAnalyze.disabled = false;
                elements.btnAnalyze.innerHTML = `<span>­ЪЊі AIТи▒т▒цтГду┐њсЂесЃЄсЃ╝сѓ┐УДБТъљсѓњт«ЪУАї</span>`;
            }, 50); 
        });

        // AIжЄЇсЂ┐С╗ўсЂЉсЂ«УАеуц║
        function displayAIWeights(weights) {
            let total = Object.values(weights).reduce((a,b)=>a+b, 0);
            let map = [
                { key: 'coScore', name: 'ТЋ░тГЌсЂ«уЏИжќбсЃЇсЃЃсЃѕсЃ»сЃ╝сѓ»жЄЇУдЂт║д' },
                { key: 'intStd', name: 'Hot/ColdТиисЂќсѓітЁитљѕ(тѕєТЋБ)жЄЇУдЂт║д' },
                { key: 'momentum', name: 'сЃъсЃФсЃЂсѓ┐сѓцсЃасЃ╗сЃбсЃАсЃ│сѓ┐сЃажЄЇУдЂт║д' },
                { key: 'adj', name: 'жџБТјЦТЋ░тГЌсЂ«Т│бтЈі(сѓ╣сЃЌсЃгсЃЃсЃЅ)жЄЇУдЂт║д' },
                { key: 'dec', name: 'уЋфтЈ░(10сЂћсЂе)сѓ░сЃФсЃ╝сЃЌтЂЈсѓісЃџсЃісЃФсЃєсѓБ' },
                { key: 'block', name: 'тї║ућ╗(сЃќсЃГсЃЃсѓ»)тѕєТЋБсѓФсЃљсЃ╝ујЄсЃџсЃісЃФсЃєсѓБ' },
                { key: 'consec', name: 'жђБуЋфТЋ░уЋ░тИИсЃџсЃісЃФсЃєсѓБ' },
                { key: 'sum', name: 'тљѕУеѕтђцуЋ░тИИсЃџсЃісЃФсЃєсѓБ' },
                { key: 'odd', name: 'тЦЄТЋ░сЃ╗тЂХТЋ░сЃљсЃЕсЃ│сѓ╣сЃџсЃісЃФсЃєсѓБ' },
                { key: 'pull', name: 'т╝ЋсЂБт╝хсѓіТЋ░уЋ░тИИсЃџсЃісЃФсЃєсѓБ' },
                { key: 'int', name: 'уиЈсЂ»сЂЙсѓітЏъТЋ░уЋ░тИИсЃџсЃісЃФсЃєсѓБ' }
            ];
            
            map.sort((a, b) => weights[b.key] - weights[a.key]);

            let html = '';
            map.forEach((item, index) => {
                let percent = ((weights[item.key] / total) * 100).toFixed(1);
                let isTop = index === 0;
                html += `
                    <div>
                        <div class="flex justify-between text-xs mb-1 ${isTop ? 'text-yellow-300 font-bold' : 'text-gray-400'}">
                            <span>${item.name} ${isTop ? '­ЪЉЉ (AIТюђжЄЇУдќ)' : ''}</span>
                            <span>жЄЇУдЂт║д: ${percent}%</span>
                        </div>
                        <div class="w-full bg-gray-700 rounded-full h-2">
                            <div class="bg-gradient-to-r ${isTop ? 'from-yellow-400 to-yellow-200' : 'from-indigo-500 to-purple-500'} h-2 rounded-full" style="width: ${percent}%"></div>
                        </div>
                    </div>
                `;
            });
            elements.aiWeightsDisplay.innerHTML = html;
        }

        function displayHistoricalScores(scores) {
            if (!scores || scores.length === 0) { elements.histScoreSection.classList.add('hidden'); return; }
            elements.histScoreSection.classList.remove('hidden');

            let totalScore = 0;
            // тЪ║уцјсѓ╣сѓ│сѓбсЂ«тѕєтИЃсѓњУф┐ТЋ┤
            let dist = [
                { label: '9800уѓ╣С╗ЦСИі', min: 9800, max: 99999, count: 0, color: 'bg-red-500' },
                { label: '9500сђю9799уѓ╣', min: 9500, max: 9799, count: 0, color: 'bg-orange-400' },
                { label: '9000сђю9499уѓ╣', min: 9000, max: 9499, count: 0, color: 'bg-yellow-400' },
                { label: '8500сђю8999уѓ╣', min: 8500, max: 8999, count: 0, color: 'bg-green-500' },
                { label: '8000сђю8499уѓ╣', min: 8000, max: 8499, count: 0, color: 'bg-blue-400' },
                { label: '8000уѓ╣ТюфТ║ђ', min: -99999, max: 7999, count: 0, color: 'bg-gray-400' }
            ];

            scores.forEach(s => {
                totalScore += s.score;
                for (let d of dist) {
                    if (s.score >= d.min && s.score <= d.max) { d.count++; break; }
                }
            });

            const avgScore = totalScore / scores.length;
            elements.avgHistScore.textContent = Math.round(avgScore) + ' уѓ╣';

            elements.scoreDistribution.innerHTML = '';
            let maxCount = Math.max(...dist.map(d => d.count));
            
            dist.forEach(d => {
                let percent = maxCount > 0 ? (d.count / maxCount) * 100 : 0;
                elements.scoreDistribution.innerHTML += `
                    <div class="flex items-center text-xs">
                        <div class="w-24 shrink-0 text-gray-700 font-bold">${d.label}</div>
                        <div class="flex-1 bg-gray-200 h-5 rounded overflow-hidden flex items-center shadow-inner">
                            <div class="${d.color} h-full transition-all duration-500" style="width: ${percent}%;"></div>
                        </div>
                        <div class="w-12 text-right shrink-0 font-bold text-gray-600">${d.count} тЏъ</div>
                    </div>
                `;
            });

            elements.recentHistScores.innerHTML = '';
            const recentScores = scores.slice(-10).reverse();
            recentScores.forEach((s, idx) => {
                let timeLabel = idx === 0 ? 'тЅЇтЏъ' : `${idx + 1}тЏътЅЇ`;
                let drawStr = s.draw.join(',');
                elements.recentHistScores.innerHTML += `
                    <li class="flex justify-between items-center py-2 border-b border-gray-200 last:border-0 hover:bg-gray-100 px-2 rounded transition">
                        <span class="text-gray-500 font-bold w-12">${timeLabel}</span>
                        <span class="text-gray-400 font-mono tracking-widest text-[11px]">${drawStr}</span>
                        <b class="${s.score < 8000 ? 'text-gray-500' : 'text-indigo-600'}">${s.score} уѓ╣</b>
                    </li>
                `;
            });
        }

        function displayAnalysis() {
            if (testTargetDraw) {
                elements.analysisTitle.innerHTML = `STEP 2: тГду┐њухљТъю №╝є AIсЃЉсЃЕсЃАсЃ╝сѓ┐ТюђжЂЕтїќ <span class="text-sm font-normal text-indigo-700 ml-2 border border-indigo-400 px-2 py-1 rounded bg-indigo-100 shadow-sm">­ЪћЇ жЂјтј╗ТцюУе╝сЃбсЃ╝сЃЅжЂЕућеСИГ</span>`;
            } else {
                elements.analysisTitle.innerHTML = `STEP 2: тГду┐њухљТъю №╝є AIсЃЉсЃЕсЃАсЃ╝сѓ┐ТюђжЂЕтїќ`;
            }

            elements.latestDraw.innerHTML = '';
            statsData.lastDraw.forEach(num => {
                let colorClass = getBallColorClass(num);
                elements.latestDraw.innerHTML += `<div class="w-8 h-8 rounded-full flex items-center justify-center text-white text-sm ${colorClass}">${num}</div>`;
            });

            let pairs = [];
            for(let i=1; i<=37; i++) {
                for(let j=i+1; j<=37; j++) {
                    if(statsData.coMatrix[i] && statsData.coMatrix[i][j] > 0) {
                        pairs.push({ p1: i, p2: j, count: statsData.coMatrix[i][j] });
                    }
                }
            }
            pairs.sort((a,b) => b.count - a.count);
            
            elements.bestPairs.innerHTML = '';
            for(let i=0; i<Math.min(10, pairs.length); i++) {
                let p = pairs[i];
                elements.bestPairs.innerHTML += `
                    <li class="flex justify-between border-b border-purple-100 py-1">
                        <span>[${p.p1.toString().padStart(2, '0')}] сЂе [${p.p2.toString().padStart(2, '0')}]</span>
                        <span class="font-bold">${p.count}тЏъ</span>
                    </li>
                `;
            }

            let decades = [];
            for(let k in statsData.decadeProb) {
                decades.push({ key: k, prob: statsData.decadeProb[k] });
            }
            decades.sort((a,b) => b.prob - a.prob);
            
            elements.bestDecades.innerHTML = '';
            for(let i=0; i<Math.min(5, decades.length); i++) {
                let d = decades[i];
                let percent = (d.prob * 100).toFixed(1);
                elements.bestDecades.innerHTML += `
                    <li class="flex flex-col">
                        <div class="flex justify-between">
                            <span class="font-mono tracking-widest">${d.key.replace(/:/g, ' - ')}</span>
                            <span class="font-bold">${percent}%</span>
                        </div>
                        <div class="w-full bg-teal-100 rounded-full h-1 mt-1">
                            <div class="bg-teal-500 h-1 rounded-full" style="width: ${percent}%"></div>
                        </div>
                    </li>
                `;
            }

            const stats = [];
            for (let i = 1; i <= 37; i++) { stats.push({ number: i, count: numberFrequencies[i] }); }
            stats.sort((a, b) => b.count - a.count);

            elements.hotNumbers.innerHTML = '';
            for (let i = 0; i < 5; i++) {
                elements.hotNumbers.innerHTML += `<li class="flex justify-between border-b border-red-200 py-1"><span>угг${i+1}СйЇ: <b>${stats[i].number}</b></span> <span>${stats[i].count}тЏъ</span></li>`;
            }

            let intervalsStats = [];
            for (let i = 1; i <= 37; i++) { intervalsStats.push({ number: i, interval: currentIntervals[i] }); }
            intervalsStats.sort((a, b) => b.interval - a.interval);
            
            elements.coldNumbers.innerHTML = '';
            for (let i = 0; i < 5; i++) {
                elements.coldNumbers.innerHTML += `<li class="flex justify-between border-b border-blue-200 py-1"><span><b>${intervalsStats[i].number}</b></span> <span class="text-blue-700">${intervalsStats[i].interval}тЏъсЂ»сЂЙсѓіСИГ</span></li>`;
            }
            
            elements.statisticalFeatures.innerHTML = `
                <li><span class="block text-gray-500 text-xs">тљѕУеѕтђцсЂ«тѕєтИЃсЃЌсЃГсЃЋсѓАсѓцсЃФ</span> <b class="text-indigo-600 text-base">т╣│тЮЄ ${Math.round(statsData.exp.sum.mean)}</b> <span class="text-xs text-gray-400">(┬▒${Math.round(statsData.exp.sum.std)})</span></li>
                <li><span class="block text-gray-500 text-xs">Hot/ColdсЂ«уљєТЃ│уџёсЂфТиисЂќсѓітЁитљѕ</span> <b class="text-indigo-600 text-base">тѕєТЋБ ${Math.round(statsData.exp.intStd.mean*10)/10}</b> <span class="text-xs text-gray-400">(┬▒${Math.round(statsData.exp.intStd.std*10)/10})</span></li>
                <li><span class="block text-gray-500 text-xs">ТЋ░тГЌсЃџсѓбсЂ«уЏИТђДсЂ«УЅ»сЂЋ(тЁ▒УхиТђД)</span> <b class="text-indigo-600 text-base">сѓ╣сѓ│сѓб ${Math.round(statsData.exp.coScore.mean)}</b> <span class="text-xs text-gray-400">(┬▒${Math.round(statsData.exp.coScore.std)})</span></li>
                <li><span class="block text-gray-500 text-xs">сЃъсЃФсЃЂсѓ┐сѓцсЃасЃ╗сЃѕсЃгсЃ│сЃЅтІбсЂё</span> <b class="text-indigo-600 text-base">т╣│тЮЄ ${Math.round(statsData.exp.momentum.mean*100)/100}</b> <span class="text-xs text-gray-400">(┬▒${Math.round(statsData.exp.momentum.std*100)/100})</span></li>
                <li><span class="block text-gray-500 text-xs">жџБТјЦТЋ░тГЌсЂ«Т│бтЈі(сѓ╣сЃЌсЃгсЃЃсЃЅ)</span> <b class="text-indigo-600 text-base">т╣│тЮЄ ${Math.round(statsData.exp.adjPull.mean*10)/10} тђІ</b> <span class="text-xs text-gray-400">(┬▒${Math.round(statsData.exp.adjPull.std*10)/10})</span></li>
                <li><span class="block text-gray-500 text-xs">тї║ућ╗(сЃќсЃГсЃЃсѓ»)сѓФсЃљсЃ╝ујЄ</span> <b class="text-indigo-600 text-base">т╣│тЮЄ ${Math.round(statsData.exp.block.mean*10)/10} у«ЄТЅђ</b> <span class="text-xs text-gray-400">(ТЋБсѓЅсЂ░сѓіт║д)</span></li>
            `;
        }

        elements.btnSimulate.addEventListener('click', () => {
            const mode = document.querySelector('input[name="simMode"]:checked').value;
            const ticketCount = parseInt(elements.ticketCount.value) || 5;
            
            elements.btnSimulate.disabled = true;
            elements.btnSimulate.innerHTML = `<div class="loader border-gray-800 border-top-yellow-200"></div> <span>Т║ќтѓЎСИГ...</span>`;
            elements.resultSection.classList.add('hidden');

            if (mode === 'count') {
                const iterations = parseInt(elements.simCount.value);
                setTimeout(() => { runMonteCarloCountMode(iterations, ticketCount); }, 50);
            } else if (mode === 'all') {
                setTimeout(() => { runAllPatternsMode(ticketCount); }, 50);
            }
        });

        function resetSimBtn() {
            elements.btnSimulate.disabled = false;
            elements.btnSimulate.innerHTML = `<span>­Ъј░ сЃюсЃфсЃЦсЃ╝сЃасѓЙсЃ╝сЃ│ТюђжЂЕтїќС║ѕТЃ│сѓњжќІтДІсЂЎсѓІ</span>`;
            elements.resultSection.classList.remove('hidden');
            elements.resultSection.scrollIntoView({ behavior: 'smooth' });
        }

        // --- РўЁ Тюђт╝исЂ«ТюђухѓУЕЋСЙАжќбТЋ░№╝ѕсѓ┐сЃ╝сѓ▓сЃЃсЃѕсЃ╗сѓГсЃБсЃфсЃќсЃгсЃ╝сѓисЃДсЃ│№╝Ѕ ---
        function evaluateDraw(draw, modelParams) {
            // 1. HuberТљЇтц▒сЂФтЪ║сЂЦсЂЈтЪ║уцјсѓ╣сѓ│сѓб№╝ѕсЃџсЃісЃФсЃєсѓБТИЏуѓ╣№╝ЅсѓњУеѕу«Ќ
            let base = calcRawScore(draw, modelParams, statsData.weights);

            // 2. сЃАсѓ┐УЕЋСЙА: тЪ║уцјсѓ╣сѓ│сѓбсЂїсђїжЂјтј╗сЂ«сЃюсЃфсЃЦсЃ╝сЃасѓЙсЃ╝сЃ│(histMean)сђЇсЂФсЂЕсѓїсЂасЂЉУ┐ЉсЂёсЂІ
            let diff = Math.abs(base.score - statsData.histMean);
            
            // 3. ти«тѕєсѓњZсѓ╣сѓ│сѓбтїќсЂЌсђЂ10000уѓ╣сЂІсѓЅТИЏуѓ╣
            // сЃюсЃфсЃЦсЃ╝сЃасѓЙсЃ╝сЃ│сЂ«т╣│тЮЄсЂФсЃћсѓ┐сЃфсЂеСИђУЄ┤сЂЎсѓїсЂ░сђЂТюђухѓсѓ╣сѓ│сѓбсЂї10000уѓ╣сЂФУ┐ЉсЂЦсЂЈ
            let zDiff = diff / Math.max(statsData.histStd, 50);
            let finalScore = 10000 - (zDiff * 250); // жІГУДњсЂфсѓГсЃБсЃфсЃќсЃгсЃ╝сѓисЃДсЃ│

            return { 
                score: finalScore, 
                rawScore: base.score, 
                sum: base.sum, 
                oddCount: base.oddCount, 
                pullCount: base.pullCount, 
                consecCount: base.consecCount, 
                intSum: base.intSum 
            };
        }

        // --- тЏъТЋ░ТїЄт«џсЃбсЃ╝сЃЅ ---
        function runMonteCarloCountMode(iterations, ticketCount) {
            let simulationResults = [];
            const modelParams = {
                lastDraw: statsData.lastDraw,
                intervals: currentIntervals,
                coMatrix: statsData.coMatrix,
                momentumMap: statsData.momentumMap,
                decadeProb: statsData.decadeProb,
                exp: statsData.exp
            };

            for (let i = 0; i < iterations; i++) {
                let draw = generateRandom7();
                let evaluation = evaluateDraw(draw, modelParams);
                simulationResults.push({ draw: draw, score: evaluation.score, details: evaluation });
            }
            
            simulationResults.sort((a, b) => b.score - a.score);

            let uniqueResults = [];
            let seen = new Set();
            for (let item of simulationResults) {
                let key = item.draw.join(',');
                if (!seen.has(key)) {
                    seen.add(key);
                    uniqueResults.push(item);
                    if (uniqueResults.length >= ticketCount * 10) break;
                }
            }

            const predictions = pickPredictions(uniqueResults, ticketCount);
            renderResults(predictions, iterations, null);
            resetSimBtn();
        }

        // --- тЁесЃЉсѓ┐сЃ╝сЃ│т«їтЁеУДБТъљсЃбсЃ╝сЃЅ ---
        function runAllPatternsMode(ticketCount) {
            const TOTAL_COMBINATIONS = 10295472;
            let processed = 0;
            const CHUNK_SIZE = 50000;
            
            let currentCombo = [1, 2, 3, 4, 5, 6, 7];
            let isDone = false;

            let topResults = [];
            let minTopScore = -Infinity;
            const KEEP_COUNT = ticketCount * 10;
            
            const modelParams = {
                lastDraw: statsData.lastDraw,
                intervals: currentIntervals,
                coMatrix: statsData.coMatrix,
                momentumMap: statsData.momentumMap,
                decadeProb: statsData.decadeProb,
                exp: statsData.exp
            };

            function processChunk() {
                let chunkCount = 0;
                while (chunkCount < CHUNK_SIZE && !isDone) {
                    let draw = [currentCombo[0], currentCombo[1], currentCombo[2], currentCombo[3], currentCombo[4], currentCombo[5], currentCombo[6]];
                    let evaluation = evaluateDraw(draw, modelParams);
                    
                    if (evaluation.score > minTopScore) {
                        topResults.push({ draw: draw, score: evaluation.score, details: evaluation });
                        topResults.sort((a, b) => b.score - a.score);
                        if (topResults.length > KEEP_COUNT) topResults.pop();
                        if (topResults.length === KEEP_COUNT) minTopScore = topResults[topResults.length - 1].score;
                    }

                    let i = 6;
                    while (i >= 0 && currentCombo[i] === 37 - 6 + i) i--;
                    if (i < 0) {
                        isDone = true;
                    } else {
                        currentCombo[i]++;
                        for (let j = i + 1; j < 7; j++) currentCombo[j] = currentCombo[j - 1] + 1;
                    }
                    
                    chunkCount++;
                    processed++;
                }

                if (isDone) {
                    const predictions = pickPredictions(topResults, ticketCount);
                    renderResults(predictions, TOTAL_COMBINATIONS, "тЁе1029СИЄжђџсѓі т«їтЁеУДБТъљ");
                    resetSimBtn();
                } else {
                    let percent = ((processed / TOTAL_COMBINATIONS) * 100).toFixed(1);
                    elements.btnSimulate.innerHTML = `
                        <div class="loader border-gray-800 border-top-yellow-200"></div> 
                        <div class="flex flex-col items-center">
                            <span class="text-sm font-bold">тЁесЃЉсѓ┐сЃ╝сЃ│сЂ«сЃюсЃфсЃЦсЃ╝сЃасѓЙсЃ╝сЃ│т░цт║дсѓњУеѕу«ЌСИГ... ${percent}%</span>
                            <span class="text-xs text-yellow-800">тЄдуљєТИѕ: ${processed.toLocaleString()} С╗Х</span>
                        </div>
                    `;
                    setTimeout(processChunk, 0);
                }
            }
            processChunk();
        }

        function pickPredictions(uniqueResults, ticketCount) {
            const predictions = [];
            if (uniqueResults.length > 0) {
                predictions.push(uniqueResults[0]); // 1СйЇсЂ»т┐ЁсЂџтЁЦсѓїсѓІ
                let candidates = uniqueResults.slice(1);
                for (let i = candidates.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [candidates[i], candidates[j]] = [candidates[j], candidates[i]];
                }
                for (let i = 0; i < ticketCount - 1 && i < candidates.length; i++) {
                    predictions.push(candidates[i]);
                }
            }
            return predictions;
        }

        // ухљТъюсЂ«ТЈЈућ╗
        function renderResults(predictions, iterations, modeText) {
            let introText = "";
            if (modeText === "тЁе1029СИЄжђџсѓі т«їтЁеУДБТъљ") {
                introText = `
                    <div class="text-center text-sm text-gray-800 mb-6 bg-yellow-100 p-5 rounded-lg border-2 border-yellow-400 shadow-sm">
                        <b class="text-yellow-700 text-lg block mb-2">­ЪћЦ ${modeText} т«їС║є ­ЪћЦ</b>
                        тЁеухёсЂ┐тљѕсѓЈсЂЏ <b>${iterations.toLocaleString()} жђџсѓі</b> тЁесЂдсѓњУеѕу«ЌТЕЪсЂДуиЈтйЊсЂЪсѓіУЕЋСЙАсЂЌсђЂ<br>
                        сђїжЂјтј╗сЂ«ТГБУДБсЃЄсЃ╝сѓ┐сЂїТюђсѓѓсѓѕсЂЈтѕєтИЃсЂЎсѓІсЃюсЃфсЃЦсЃ╝сЃасѓЙсЃ╝сЃ│№╝ѕжЂЕт║дсЂфУЇњсѓї№╝ЅсђЇсЂФсЃћсѓ┐сЃфсЂеуЮђтю░сЂЌсЂЪсђЂуюЪсЂФуЈЙт«ЪуџёсЂфТюђт╝исЂ« <b>${predictions.length} сЃЉсѓ┐сЃ╝сЃ│</b>сѓњТійтЄ║сЂЌсЂЙсЂЌсЂЪ№╝Ђ
                    </div>
                `;
            } else {
                introText = `
                    <div class="text-center text-sm text-gray-600 mb-6 bg-indigo-50 p-4 rounded-lg border border-indigo-100">
                        С╗«ТЃ│сЃФсЃ╝сЃгсЃЃсЃѕсѓњ <b>${iterations.toLocaleString()} тЏъ</b> т«ЪУАїсЂЌсЂЙсЂЌсЂЪсђѓ<br>
                        сђїжЂјтј╗сЂ«ТГБУДБсЃЄсЃ╝сѓ┐сЂїТюђсѓѓсѓѕсЂЈтѕєтИЃсЂЎсѓІсЃюсЃфсЃЦсЃ╝сЃасѓЙсЃ╝сЃ│№╝ѕжЂЕт║дсЂфУЇњсѓї№╝ЅсђЇсЂФТюђсѓѓтљѕУЄ┤сЂЌсЂЪСИіСйЇ ${predictions.length} сЃЉсѓ┐сЃ╝сЃ│сѓњтј│жЂИУАеуц║сЂЌсЂдсЂёсЂЙсЂЎсђѓ
                    </div>
                `;
            }

            if (testTargetDraw) {
                const targetEvaluation = evaluateDraw(testTargetDraw, {
                    lastDraw: statsData.lastDraw,
                    intervals: currentIntervals,
                    coMatrix: statsData.coMatrix,
                    momentumMap: statsData.momentumMap,
                    decadeProb: statsData.decadeProb,
                    exp: statsData.exp
                });
                
                introText += `
                    <div class="mt-4 p-4 bg-indigo-50 border-2 border-indigo-300 rounded-lg text-left shadow-sm">
                        <b class="text-indigo-800 block mb-2 text-lg">­Ъј» сЃљсЃЃсѓ»сЃєсѓ╣сЃѕ№╝ѕжЂјтј╗ТцюУе╝№╝ЅуГћсЂѕтљѕсѓЈсЂЏ</b>
                        <p class="text-sm text-gray-700 mb-2">тГду┐њсЂІсѓЅжЎцтцќсЂЌсЂджџасЂЌсЂдсЂісЂёсЂЪсђїТГБУДБ№╝ѕТюђТќ░тЏъ№╝ЅсђЇсЂ«сЃЄсЃ╝сѓ┐сЂДсЂЎсђѓсЂЊсЂ«ухљТъюсЂеС║ѕТЃ│сѓњТ»ћУ╝ЃсЂЌсЂЙсЂЎсђѓ</p>
                        <div class="flex flex-wrap items-center gap-2">
                            <span class="text-sm font-bold text-gray-700 w-16">ТюгТЋ░тГЌ:</span>
                            ${testTargetDraw.map(n => `<div class="w-8 h-8 rounded-full flex items-center justify-center text-white text-sm font-bold shadow-sm ${getBallColorClass(n)}">${n}</div>`).join('')}
                        </div>
                        ${testTargetBonus.length > 0 ? `
                        <div class="flex flex-wrap items-center gap-2 mt-2">
                            <span class="text-sm font-bold text-gray-700 w-16">сЃюсЃ╝сЃісѓ╣:</span>
                            ${testTargetBonus.map(n => `<div class="w-8 h-8 rounded-full flex items-center justify-center text-gray-700 text-sm font-bold bg-gray-200 border border-gray-400 shadow-sm">${n}</div>`).join('')}
                        </div>
                        ` : ''}
                        <div class="mt-3 text-sm text-indigo-700 font-bold bg-white px-3 py-2 rounded inline-block border border-indigo-200 shadow-sm">
                            ­Ъј» ТюђухѓТюђжЂЕтїќсѓ╣сѓ│сѓб (т░цт║д): <span class="text-xl text-red-600">${Math.round(targetEvaluation.score)}</span> уѓ╣
                            <span class="text-xs text-gray-500 font-normal ml-2">(тЪ║уцјсѓ╣сѓ│сѓб: ${Math.round(targetEvaluation.rawScore)})</span>
                        </div>
                    </div>
                `;
            }

            elements.predictionResults.innerHTML = introText;

            predictions.forEach((item, index) => {
                const draw = item.draw;
                const details = item.details;
                
                let matchCount = 0;
                let bonusMatch = 0;
                if (testTargetDraw) {
                    draw.forEach(n => {
                        if (testTargetDraw.includes(n)) matchCount++;
                        else if (testTargetBonus.includes(n)) bonusMatch++;
                    });
                }
                
                let html = `
                    <div class="bg-white p-4 rounded-xl shadow-md border ${index === 0 ? 'border-yellow-400 bg-yellow-50/30' : 'border-gray-200'} flex flex-col items-center gap-3 relative overflow-hidden">
                        ${index === 0 ? '<div class="absolute top-0 left-0 bg-yellow-400 text-xs font-bold px-2 py-1 rounded-br-lg">ТюгтЉйС║ѕТЃ│</div>' : ''}
                        
                        <div class="w-full flex justify-between items-center border-b pb-2 mb-1 mt-2">
                            <span class="font-bold text-gray-700 bg-gray-100 px-3 py-1 rounded-full text-sm">С║ѕТЃ│ ${index + 1}</span>
                            <span class="text-xs text-gray-500 bg-gray-50 px-2 py-1 rounded border font-bold ${details.score >= 9500 ? 'text-red-600 border-red-200 bg-red-50' : ''}">
                                ТюђжЂЕтїќсѓ╣сѓ│сѓб: <span class="text-base">${Math.round(details.score)}</span>
                                <span class="text-[10px] text-gray-400 font-normal">(тЪ║уцј: ${Math.round(details.rawScore)})</span>
                            </span>
                        </div>
                        <div class="flex flex-wrap gap-2 justify-center py-2">
                `;
                
                draw.forEach(num => {
                    const colorClass = getBallColorClass(num);
                    html += `<div class="loto-ball ${colorClass} hover:scale-110 transition-transform cursor-default">${num}</div>`;
                });

                let oddStr = `${details.oddCount}:${7-details.oddCount}`;
                html += `
                        </div>
                        <div class="w-full grid grid-cols-2 md:grid-cols-4 gap-2 text-xs text-gray-600 mt-2 bg-gray-50 p-3 rounded border border-gray-100">
                            <div class="flex flex-col"><span class="text-gray-400">тЅЇтЏъсЂІсѓЅсЂ«т╝ЋсЂБт╝хсѓі</span><b class="${details.pullCount > 0 ? 'text-blue-600' : ''}">${details.pullCount} тђІ</b></div>
                            <div class="flex flex-col"><span class="text-gray-400">жђБуЋфсЃџсѓбТЋ░</span><b class="${details.consecCount > 0 ? 'text-green-600' : ''}">${details.consecCount} ухё</b></div>
                            <div class="flex flex-col"><span class="text-gray-400">тЦЄтЂХТ»ћ (тЦЄ:тЂХ)</span><b>${oddStr}</b></div>
                            <div class="flex flex-col"><span class="text-gray-400">тљѕУеѕтђц</span><b>${details.sum}</b></div>
                        </div>
                `;

                if (testTargetDraw) {
                    let prizeText = "сЃЈсѓ║сЃг";
                    let bgClass = "bg-gray-50 border-gray-200 text-gray-600";
                    
                    if (matchCount === 7) { prizeText = "­ЪЉЉ 1уГЅуЏИтйЊ№╝ЂтцДтйЊсѓі№╝Ђ№╝Ђ"; bgClass = "bg-yellow-100 border-yellow-400 text-yellow-800 font-bold"; }
                    else if (matchCount === 6 && bonusMatch >= 1) { prizeText = "Рюе 2уГЅуЏИтйЊ№╝Ђ"; bgClass = "bg-red-50 border-red-300 text-red-700 font-bold"; }
                    else if (matchCount === 6) { prizeText = "­ЪјЅ 3уГЅуЏИтйЊ№╝Ђ"; bgClass = "bg-red-50 border-red-300 text-red-700 font-bold"; }
                    else if (matchCount === 5) { prizeText = "­ЪЉЇ 4уГЅуЏИтйЊ"; bgClass = "bg-blue-50 border-blue-300 text-blue-700 font-bold"; }
                    else if (matchCount === 4) { prizeText = "­ЪЉЈ 5уГЅуЏИтйЊ"; bgClass = "bg-green-50 border-green-300 text-green-700 font-bold"; }
                    else if (matchCount === 3 && bonusMatch >= 1) { prizeText = "Рў║№ИЈ 6уГЅуЏИтйЊ"; bgClass = "bg-indigo-50 border-indigo-300 text-indigo-700 font-bold"; }
                    
                    let hitText = `ТюгТЋ░тГЌ <b>${matchCount}</b> тђІСИђУЄ┤`;
                    if (bonusMatch > 0) hitText += ` (сЃюсЃ╝сЃісѓ╣ <b>${bonusMatch}</b> тђІ)`;
                    
                    html += `
                        <div class="w-full mt-3 p-3 text-center text-sm border rounded-lg ${bgClass} shadow-inner">
                            уГћсЂѕтљѕсѓЈсЂЏ: ${hitText} Ръћ <span class="text-base">${prizeText}</span>
                        </div>
                    `;
                }

                html += `</div>`;
                elements.predictionResults.innerHTML += html;
            });
        }
    </script>
</body>
</html>
